  0%|          | 0/2373 [00:00<?, ?it/s]It is strongly recommended to train Gemma3 models with the `eager` attention implementation instead of `sdpa`. Use `eager` with `AutoModelForCausalLM.from_pretrained('<path-to-checkpoint>', attn_implementation='eager')`.
                                                    
{'loss': 1.6843, 'grad_norm': 12.043771743774414, 'learning_rate': 1.992414664981037e-05, 'mean_token_accuracy': 0.5797257125377655, 'epoch': 0.01}
{'loss': 1.2515, 'grad_norm': 29.818605422973633, 'learning_rate': 1.9839865149599663e-05, 'mean_token_accuracy': 0.6299580872058869, 'epoch': 0.03}
{'loss': 1.2652, 'grad_norm': 7.60041618347168, 'learning_rate': 1.975558364938896e-05, 'mean_token_accuracy': 0.6158402979373931, 'epoch': 0.04}
{'loss': 1.2244, 'grad_norm': 10.047945022583008, 'learning_rate': 1.9671302149178258e-05, 'mean_token_accuracy': 0.6229622721672058, 'epoch': 0.05}
{'loss': 1.2091, 'grad_norm': 7.801754951477051, 'learning_rate': 1.9587020648967552e-05, 'mean_token_accuracy': 0.6294810771942139, 'epoch': 0.06}
{'loss': 1.0036, 'grad_norm': 8.411123275756836, 'learning_rate': 1.950273914875685e-05, 'mean_token_accuracy': 0.6369327187538147, 'epoch': 0.08}
{'loss': 1.0876, 'grad_norm': 6.6836323738098145, 'learning_rate': 1.9418457648546144e-05, 'mean_token_accuracy': 0.6394816517829895, 'epoch': 0.09}
{'loss': 1.1466, 'grad_norm': 6.906060695648193, 'learning_rate': 1.9334176148335442e-05, 'mean_token_accuracy': 0.629526799917221, 'epoch': 0.1}
{'loss': 1.0455, 'grad_norm': 5.760012149810791, 'learning_rate': 1.924989464812474e-05, 'mean_token_accuracy': 0.6461834073066711, 'epoch': 0.11}
{'loss': 1.04, 'grad_norm': 8.654391288757324, 'learning_rate': 1.9165613147914034e-05, 'mean_token_accuracy': 0.6358038306236267, 'epoch': 0.13}
{'loss': 1.1122, 'grad_norm': 6.150396347045898, 'learning_rate': 1.908133164770333e-05, 'mean_token_accuracy': 0.6446408033370972, 'epoch': 0.14}
{'loss': 0.9461, 'grad_norm': 5.369933128356934, 'learning_rate': 1.8997050147492625e-05, 'mean_token_accuracy': 0.6696231245994568, 'epoch': 0.15}
{'loss': 1.0787, 'grad_norm': 5.434561729431152, 'learning_rate': 1.8912768647281923e-05, 'mean_token_accuracy': 0.6456558406352997, 'epoch': 0.16}
{'loss': 0.9512, 'grad_norm': 5.589954376220703, 'learning_rate': 1.882848714707122e-05, 'mean_token_accuracy': 0.6582343757152558, 'epoch': 0.18}
{'loss': 1.0609, 'grad_norm': 6.187712669372559, 'learning_rate': 1.8744205646860515e-05, 'mean_token_accuracy': 0.6507044613361359, 'epoch': 0.19}
{'loss': 0.968, 'grad_norm': 4.382734298706055, 'learning_rate': 1.8659924146649812e-05, 'mean_token_accuracy': 0.6703250885009766, 'epoch': 0.2}
{'loss': 0.8837, 'grad_norm': 4.250710487365723, 'learning_rate': 1.8575642646439107e-05, 'mean_token_accuracy': 0.672342836856842, 'epoch': 0.21}
{'loss': 0.9769, 'grad_norm': 5.279664993286133, 'learning_rate': 1.8491361146228404e-05, 'mean_token_accuracy': 0.6552593946456909, 'epoch': 0.23}
{'loss': 1.0184, 'grad_norm': 4.531729698181152, 'learning_rate': 1.8407079646017702e-05, 'mean_token_accuracy': 0.6634033739566803, 'epoch': 0.24}
{'loss': 0.9952, 'grad_norm': 4.397749900817871, 'learning_rate': 1.8322798145806996e-05, 'mean_token_accuracy': 0.6639548122882843, 'epoch': 0.25}
{'loss': 1.0952, 'grad_norm': 4.064805507659912, 'learning_rate': 1.8238516645596293e-05, 'mean_token_accuracy': 0.652176022529602, 'epoch': 0.27}
{'loss': 0.9584, 'grad_norm': 6.395348072052002, 'learning_rate': 1.815423514538559e-05, 'mean_token_accuracy': 0.6696989297866821, 'epoch': 0.28}
{'loss': 0.9712, 'grad_norm': 11.993179321289062, 'learning_rate': 1.8069953645174885e-05, 'mean_token_accuracy': 0.6642230927944184, 'epoch': 0.29}
{'loss': 0.9348, 'grad_norm': 6.23803186416626, 'learning_rate': 1.7985672144964183e-05, 'mean_token_accuracy': 0.6825974524021149, 'epoch': 0.3}
{'loss': 0.8285, 'grad_norm': 11.399024963378906, 'learning_rate': 1.7901390644753477e-05, 'mean_token_accuracy': 0.6916700780391694, 'epoch': 0.32}
{'loss': 0.98, 'grad_norm': 5.970376491546631, 'learning_rate': 1.7817109144542775e-05, 'mean_token_accuracy': 0.6654463529586792, 'epoch': 0.33}
{'loss': 0.9673, 'grad_norm': 5.3904290199279785, 'learning_rate': 1.7732827644332072e-05, 'mean_token_accuracy': 0.676445484161377, 'epoch': 0.34}
{'loss': 0.8709, 'grad_norm': 8.180001258850098, 'learning_rate': 1.7648546144121366e-05, 'mean_token_accuracy': 0.707244735956192, 'epoch': 0.35}
{'loss': 0.8296, 'grad_norm': 10.299878120422363, 'learning_rate': 1.756426464391066e-05, 'mean_token_accuracy': 0.6994382560253143, 'epoch': 0.37}
{'loss': 0.7969, 'grad_norm': 5.184967994689941, 'learning_rate': 1.7479983143699958e-05, 'mean_token_accuracy': 0.6859397232532501, 'epoch': 0.38}
{'loss': 0.9088, 'grad_norm': 5.551300048828125, 'learning_rate': 1.7395701643489256e-05, 'mean_token_accuracy': 0.7000467658042908, 'epoch': 0.39}
{'loss': 0.8947, 'grad_norm': 5.105880260467529, 'learning_rate': 1.7311420143278553e-05, 'mean_token_accuracy': 0.6712635338306427, 'epoch': 0.4}
{'loss': 0.9665, 'grad_norm': 4.882806301116943, 'learning_rate': 1.7227138643067848e-05, 'mean_token_accuracy': 0.6872187674045562, 'epoch': 0.42}
{'loss': 0.9014, 'grad_norm': 4.889361381530762, 'learning_rate': 1.7142857142857142e-05, 'mean_token_accuracy': 0.6884124636650085, 'epoch': 0.43}
{'loss': 0.8886, 'grad_norm': 5.016716003417969, 'learning_rate': 1.705857564264644e-05, 'mean_token_accuracy': 0.6931197345256805, 'epoch': 0.44}
{'loss': 0.7678, 'grad_norm': 4.857272624969482, 'learning_rate': 1.6974294142435737e-05, 'mean_token_accuracy': 0.7161100149154663, 'epoch': 0.46}
{'loss': 0.9039, 'grad_norm': 5.310757160186768, 'learning_rate': 1.6890012642225035e-05, 'mean_token_accuracy': 0.6903438091278076, 'epoch': 0.47}
{'loss': 0.7714, 'grad_norm': 3.533139944076538, 'learning_rate': 1.680573114201433e-05, 'mean_token_accuracy': 0.7085507869720459, 'epoch': 0.48}
{'loss': 0.9122, 'grad_norm': 6.4911603927612305, 'learning_rate': 1.6721449641803626e-05, 'mean_token_accuracy': 0.6873311221599578, 'epoch': 0.49}
{'loss': 0.9397, 'grad_norm': 5.122278690338135, 'learning_rate': 1.663716814159292e-05, 'mean_token_accuracy': 0.7027361989021301, 'epoch': 0.51}
{'loss': 0.9039, 'grad_norm': 5.299417018890381, 'learning_rate': 1.6552886641382218e-05, 'mean_token_accuracy': 0.7043024599552155, 'epoch': 0.52}
{'loss': 0.8759, 'grad_norm': 4.379001617431641, 'learning_rate': 1.6468605141171516e-05, 'mean_token_accuracy': 0.7064356684684754, 'epoch': 0.53}
{'loss': 0.7728, 'grad_norm': 4.724052429199219, 'learning_rate': 1.638432364096081e-05, 'mean_token_accuracy': 0.718280577659607, 'epoch': 0.54}
{'loss': 0.8599, 'grad_norm': 5.334225654602051, 'learning_rate': 1.6300042140750108e-05, 'mean_token_accuracy': 0.7269174635410309, 'epoch': 0.56}
{'loss': 0.8467, 'grad_norm': 4.561659812927246, 'learning_rate': 1.6215760640539402e-05, 'mean_token_accuracy': 0.6984525978565216, 'epoch': 0.57}
{'loss': 0.7577, 'grad_norm': 4.453609466552734, 'learning_rate': 1.61314791403287e-05, 'mean_token_accuracy': 0.7238019049167633, 'epoch': 0.58}
{'loss': 0.8002, 'grad_norm': 6.13311243057251, 'learning_rate': 1.6047197640117994e-05, 'mean_token_accuracy': 0.7186525762081146, 'epoch': 0.59}
{'loss': 0.8053, 'grad_norm': 5.736315727233887, 'learning_rate': 1.596291613990729e-05, 'mean_token_accuracy': 0.728576946258545, 'epoch': 0.61}
{'loss': 0.8299, 'grad_norm': 5.020557403564453, 'learning_rate': 1.587863463969659e-05, 'mean_token_accuracy': 0.7080359041690827, 'epoch': 0.62}
{'loss': 0.8813, 'grad_norm': 5.418985366821289, 'learning_rate': 1.5794353139485886e-05, 'mean_token_accuracy': 0.7010575592517853, 'epoch': 0.63}
{'loss': 0.7292, 'grad_norm': 5.414495944976807, 'learning_rate': 1.571007163927518e-05, 'mean_token_accuracy': 0.7268172144889832, 'epoch': 0.64}
{'loss': 0.9139, 'grad_norm': 3.9343957901000977, 'learning_rate': 1.5625790139064475e-05, 'mean_token_accuracy': 0.6893438339233399, 'epoch': 0.66}
{'loss': 0.814, 'grad_norm': 3.8502004146575928, 'learning_rate': 1.5541508638853772e-05, 'mean_token_accuracy': 0.7111660242080688, 'epoch': 0.67}
{'loss': 0.87, 'grad_norm': 5.215439319610596, 'learning_rate': 1.545722713864307e-05, 'mean_token_accuracy': 0.7210196912288666, 'epoch': 0.68}
{'loss': 0.8285, 'grad_norm': 4.590780735015869, 'learning_rate': 1.5372945638432368e-05, 'mean_token_accuracy': 0.7281621992588043, 'epoch': 0.7}
{'loss': 0.8645, 'grad_norm': 5.141482353210449, 'learning_rate': 1.5288664138221662e-05, 'mean_token_accuracy': 0.7209042847156525, 'epoch': 0.71}
{'loss': 0.7875, 'grad_norm': 4.5174880027771, 'learning_rate': 1.5204382638010958e-05, 'mean_token_accuracy': 0.7260203301906586, 'epoch': 0.72}
{'loss': 0.7147, 'grad_norm': 7.58151912689209, 'learning_rate': 1.5120101137800254e-05, 'mean_token_accuracy': 0.7373924434185029, 'epoch': 0.73}
{'loss': 0.6542, 'grad_norm': 3.965745687484741, 'learning_rate': 1.5035819637589551e-05, 'mean_token_accuracy': 0.7520891308784485, 'epoch': 0.75}
{'loss': 0.689, 'grad_norm': 5.686529159545898, 'learning_rate': 1.4951538137378847e-05, 'mean_token_accuracy': 0.7554467797279358, 'epoch': 0.76}
{'loss': 0.7138, 'grad_norm': 4.009847164154053, 'learning_rate': 1.4867256637168143e-05, 'mean_token_accuracy': 0.7381217896938324, 'epoch': 0.77}
{'loss': 0.7412, 'grad_norm': 4.39668083190918, 'learning_rate': 1.4782975136957439e-05, 'mean_token_accuracy': 0.749932986497879, 'epoch': 0.78}
{'loss': 0.622, 'grad_norm': 4.649344444274902, 'learning_rate': 1.4698693636746735e-05, 'mean_token_accuracy': 0.7664176881313324, 'epoch': 0.8}
{'loss': 0.7515, 'grad_norm': 4.539229869842529, 'learning_rate': 1.461441213653603e-05, 'mean_token_accuracy': 0.7248770296573639, 'epoch': 0.81}
{'loss': 0.6925, 'grad_norm': 4.437675476074219, 'learning_rate': 1.4530130636325328e-05, 'mean_token_accuracy': 0.762169075012207, 'epoch': 0.82}
{'loss': 0.7459, 'grad_norm': 5.970398902893066, 'learning_rate': 1.4445849136114624e-05, 'mean_token_accuracy': 0.7488652467727661, 'epoch': 0.83}
{'loss': 0.7324, 'grad_norm': 4.868198871612549, 'learning_rate': 1.4361567635903922e-05, 'mean_token_accuracy': 0.7462991714477539, 'epoch': 0.85}
{'loss': 0.8273, 'grad_norm': 4.490753650665283, 'learning_rate': 1.4277286135693216e-05, 'mean_token_accuracy': 0.7268925070762634, 'epoch': 0.86}
{'loss': 0.7064, 'grad_norm': 4.2607645988464355, 'learning_rate': 1.4193004635482512e-05, 'mean_token_accuracy': 0.7385945916175842, 'epoch': 0.87}
{'loss': 0.6587, 'grad_norm': 4.79465389251709, 'learning_rate': 1.410872313527181e-05, 'mean_token_accuracy': 0.7721499323844909, 'epoch': 0.88}
{'loss': 0.7492, 'grad_norm': 6.145864009857178, 'learning_rate': 1.4024441635061105e-05, 'mean_token_accuracy': 0.7434809327125549, 'epoch': 0.9}
{'loss': 0.639, 'grad_norm': 4.923140525817871, 'learning_rate': 1.3940160134850403e-05, 'mean_token_accuracy': 0.7727374792098999, 'epoch': 0.91}
{'loss': 0.6062, 'grad_norm': 3.631518840789795, 'learning_rate': 1.3855878634639697e-05, 'mean_token_accuracy': 0.7427679300308228, 'epoch': 0.92}
{'loss': 0.7326, 'grad_norm': 4.282624244689941, 'learning_rate': 1.3771597134428993e-05, 'mean_token_accuracy': 0.7574477791786194, 'epoch': 0.94}
{'loss': 0.6536, 'grad_norm': 8.350817680358887, 'learning_rate': 1.368731563421829e-05, 'mean_token_accuracy': 0.7862219989299775, 'epoch': 0.95}
{'loss': 0.648, 'grad_norm': 4.104454040527344, 'learning_rate': 1.3603034134007586e-05, 'mean_token_accuracy': 0.7683672964572906, 'epoch': 0.96}
{'loss': 0.6147, 'grad_norm': 5.293552398681641, 'learning_rate': 1.3518752633796884e-05, 'mean_token_accuracy': 0.7819670259952545, 'epoch': 0.97}
{'loss': 0.5974, 'grad_norm': 5.480958938598633, 'learning_rate': 1.343447113358618e-05, 'mean_token_accuracy': 0.7920337796211243, 'epoch': 0.99}
{'loss': 0.7074, 'grad_norm': 6.336430549621582, 'learning_rate': 1.3350189633375474e-05, 'mean_token_accuracy': 0.7462919592857361, 'epoch': 1.0}
{'loss': 0.5703, 'grad_norm': 4.9752984046936035, 'learning_rate': 1.3265908133164772e-05, 'mean_token_accuracy': 0.7747815907001495, 'epoch': 1.01}
{'loss': 0.6035, 'grad_norm': 4.228677749633789, 'learning_rate': 1.3181626632954068e-05, 'mean_token_accuracy': 0.7858294069766998, 'epoch': 1.02}
{'loss': 0.6477, 'grad_norm': 5.965301990509033, 'learning_rate': 1.3097345132743363e-05, 'mean_token_accuracy': 0.7892282485961915, 'epoch': 1.04}
{'loss': 0.6165, 'grad_norm': 4.644700050354004, 'learning_rate': 1.3013063632532661e-05, 'mean_token_accuracy': 0.780070286989212, 'epoch': 1.05}
{'loss': 0.5434, 'grad_norm': 6.732544422149658, 'learning_rate': 1.2928782132321955e-05, 'mean_token_accuracy': 0.8061740279197693, 'epoch': 1.06}
{'loss': 0.5865, 'grad_norm': 4.350344181060791, 'learning_rate': 1.2844500632111251e-05, 'mean_token_accuracy': 0.799446040391922, 'epoch': 1.07}
{'loss': 0.6172, 'grad_norm': 5.386643409729004, 'learning_rate': 1.2760219131900549e-05, 'mean_token_accuracy': 0.7874261021614075, 'epoch': 1.09}
{'loss': 0.5917, 'grad_norm': 4.455834865570068, 'learning_rate': 1.2675937631689845e-05, 'mean_token_accuracy': 0.7893923580646515, 'epoch': 1.1}
{'loss': 0.519, 'grad_norm': 5.065108776092529, 'learning_rate': 1.2591656131479142e-05, 'mean_token_accuracy': 0.7996431767940522, 'epoch': 1.11}
{'loss': 0.5345, 'grad_norm': 15.855073928833008, 'learning_rate': 1.2507374631268438e-05, 'mean_token_accuracy': 0.8085941731929779, 'epoch': 1.13}
{'loss': 0.5997, 'grad_norm': 4.454273700714111, 'learning_rate': 1.2423093131057732e-05, 'mean_token_accuracy': 0.7906854152679443, 'epoch': 1.14}
{'loss': 0.5379, 'grad_norm': 4.217257499694824, 'learning_rate': 1.233881163084703e-05, 'mean_token_accuracy': 0.7963029623031617, 'epoch': 1.15}
{'loss': 0.5695, 'grad_norm': 5.999189853668213, 'learning_rate': 1.2254530130636326e-05, 'mean_token_accuracy': 0.8056860208511353, 'epoch': 1.16}
{'loss': 0.5696, 'grad_norm': 4.296699047088623, 'learning_rate': 1.2170248630425623e-05, 'mean_token_accuracy': 0.7942065179347992, 'epoch': 1.18}
{'loss': 0.5057, 'grad_norm': 4.695600509643555, 'learning_rate': 1.208596713021492e-05, 'mean_token_accuracy': 0.8051976501941681, 'epoch': 1.19}
{'loss': 0.5457, 'grad_norm': 4.3530497550964355, 'learning_rate': 1.2001685630004217e-05, 'mean_token_accuracy': 0.7861681401729583, 'epoch': 1.2}
{'loss': 0.6034, 'grad_norm': 4.673202037811279, 'learning_rate': 1.1917404129793511e-05, 'mean_token_accuracy': 0.800053995847702, 'epoch': 1.21}
{'loss': 0.5615, 'grad_norm': 5.274468898773193, 'learning_rate': 1.1833122629582807e-05, 'mean_token_accuracy': 0.7858218669891357, 'epoch': 1.23}
{'loss': 0.5952, 'grad_norm': 3.9896514415740967, 'learning_rate': 1.1748841129372105e-05, 'mean_token_accuracy': 0.7819939374923706, 'epoch': 1.24}
{'loss': 0.5757, 'grad_norm': 4.746459007263184, 'learning_rate': 1.16645596291614e-05, 'mean_token_accuracy': 0.7954668760299682, 'epoch': 1.25}
{'loss': 0.5219, 'grad_norm': 4.358062267303467, 'learning_rate': 1.1580278128950696e-05, 'mean_token_accuracy': 0.8166287004947662, 'epoch': 1.26}
{'loss': 0.5442, 'grad_norm': 5.293862342834473, 'learning_rate': 1.1495996628739992e-05, 'mean_token_accuracy': 0.7878525912761688, 'epoch': 1.28}
{'loss': 0.5107, 'grad_norm': 6.174870491027832, 'learning_rate': 1.1411715128529288e-05, 'mean_token_accuracy': 0.8128748774528504, 'epoch': 1.29}
{'loss': 0.4767, 'grad_norm': 3.2092971801757812, 'learning_rate': 1.1327433628318584e-05, 'mean_token_accuracy': 0.8230005860328674, 'epoch': 1.3}
{'loss': 0.418, 'grad_norm': 4.85679817199707, 'learning_rate': 1.1243152128107882e-05, 'mean_token_accuracy': 0.8278348088264466, 'epoch': 1.31}
{'loss': 0.5792, 'grad_norm': 4.552063941955566, 'learning_rate': 1.1158870627897178e-05, 'mean_token_accuracy': 0.7809309720993042, 'epoch': 1.33}
{'loss': 0.4957, 'grad_norm': 4.3040361404418945, 'learning_rate': 1.1074589127686475e-05, 'mean_token_accuracy': 0.8162066042423248, 'epoch': 1.34}
{'loss': 0.6285, 'grad_norm': 4.589742183685303, 'learning_rate': 1.099030762747577e-05, 'mean_token_accuracy': 0.8003885090351105, 'epoch': 1.35}
{'loss': 0.5578, 'grad_norm': 3.4578795433044434, 'learning_rate': 1.0906026127265065e-05, 'mean_token_accuracy': 0.806226372718811, 'epoch': 1.37}
{'loss': 0.4695, 'grad_norm': 5.2057085037231445, 'learning_rate': 1.0821744627054363e-05, 'mean_token_accuracy': 0.8328019440174103, 'epoch': 1.38}
{'loss': 0.4807, 'grad_norm': 5.5172834396362305, 'learning_rate': 1.0737463126843659e-05, 'mean_token_accuracy': 0.8325779497623443, 'epoch': 1.39}
{'loss': 0.4887, 'grad_norm': 4.976266860961914, 'learning_rate': 1.0653181626632956e-05, 'mean_token_accuracy': 0.8119287252426147, 'epoch': 1.4}
{'loss': 0.4419, 'grad_norm': 5.205692291259766, 'learning_rate': 1.056890012642225e-05, 'mean_token_accuracy': 0.843038147687912, 'epoch': 1.42}
{'loss': 0.5363, 'grad_norm': 5.00475549697876, 'learning_rate': 1.0484618626211546e-05, 'mean_token_accuracy': 0.8178144752979278, 'epoch': 1.43}
{'loss': 0.4978, 'grad_norm': 5.6339850425720215, 'learning_rate': 1.0400337126000844e-05, 'mean_token_accuracy': 0.8141046464443207, 'epoch': 1.44}
{'loss': 0.5009, 'grad_norm': 4.493405818939209, 'learning_rate': 1.031605562579014e-05, 'mean_token_accuracy': 0.8244827151298523, 'epoch': 1.45}
{'loss': 0.4833, 'grad_norm': 6.87943172454834, 'learning_rate': 1.0231774125579438e-05, 'mean_token_accuracy': 0.8170770168304443, 'epoch': 1.47}
{'loss': 0.5421, 'grad_norm': 4.474010944366455, 'learning_rate': 1.0147492625368733e-05, 'mean_token_accuracy': 0.7944219529628753, 'epoch': 1.48}
{'loss': 0.4369, 'grad_norm': 7.047698974609375, 'learning_rate': 1.0063211125158028e-05, 'mean_token_accuracy': 0.839932256937027, 'epoch': 1.49}
{'loss': 0.4606, 'grad_norm': 4.282992362976074, 'learning_rate': 9.978929624947325e-06, 'mean_token_accuracy': 0.8305398762226105, 'epoch': 1.5}
{'loss': 0.406, 'grad_norm': 4.100840091705322, 'learning_rate': 9.894648124736621e-06, 'mean_token_accuracy': 0.8544687569141388, 'epoch': 1.52}
