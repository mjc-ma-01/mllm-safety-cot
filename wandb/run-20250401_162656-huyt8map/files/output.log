 25%|██▌       | 24/96 [00:27<00:59,  1.22it/Traceback (most recent call last):
{'loss': 1.9678, 'grad_norm': 4.462658882141113, 'learning_rate': 9.73465064747553e-06, 'epoch': 0.21}
{'loss': 1.4097, 'grad_norm': 3.612832546234131, 'learning_rate': 8.966766701456177e-06, 'epoch': 0.41}
  File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/torch/serialization.py", line 944, in save
{'eval_loss': 1.5453970432281494, 'eval_runtime': 0.5582, 'eval_samples_per_second': 308.125, 'eval_steps_per_second': 10.749, 'epoch': 0.49}
    _save(
  File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/torch/serialization.py", line 1216, in _save
    zip_file.write_record(name, storage, num_bytes)
RuntimeError: [enforce fail at inline_container.cc:815] . PytorchStreamWriter failed writing file data/2: file write failed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_llm_cot.py", line 176, in <module>
    train()
  File "/mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_llm_cot.py", line 170, in train
    trainer.train()
  File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 2171, in train
    return inner_training_loop(
           ^^^^^^^^^^^^^^^^^^^^
  File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 2598, in _inner_training_loop
    self._maybe_log_save_evaluate(
  File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 3078, in _maybe_log_save_evaluate
    self._save_checkpoint(model, trial)
  File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 3213, in _save_checkpoint
    self._save_optimizer_and_scheduler(output_dir)
  File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 3323, in _save_optimizer_and_scheduler
    self.model_wrapped.save_checkpoint(output_dir)
  File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 3206, in save_checkpoint
    self._save_zero_checkpoint(save_dir, tag)
  File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 3567, in _save_zero_checkpoint
    self.checkpoint_engine.save(zero_sd, zero_checkpoint_name)
  File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/deepspeed/runtime/checkpoint_engine/torch_checkpoint_engine.py", line 22, in save
    torch.save(state_dict, path)
  File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/torch/serialization.py", line 943, in save
    with _open_zipfile_writer(f) as opened_zipfile:
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/torch/serialization.py", line 784, in __exit__
    self.file_like.write_end_of_file()
RuntimeError: [enforce fail at inline_container.cc:626] . unexpected pos 4015002240 vs 4015002128
[rank0]: Traceback (most recent call last):
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/torch/serialization.py", line 944, in save
[rank0]:     _save(
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/torch/serialization.py", line 1216, in _save
[rank0]:     zip_file.write_record(name, storage, num_bytes)
[rank0]: RuntimeError: [enforce fail at inline_container.cc:815] . PytorchStreamWriter failed writing file data/2: file write failed

[rank0]: During handling of the above exception, another exception occurred:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_llm_cot.py", line 176, in <module>
[rank0]:     train()
[rank0]:   File "/mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_llm_cot.py", line 170, in train
[rank0]:     trainer.train()
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 2171, in train
[rank0]:     return inner_training_loop(
[rank0]:            ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 2598, in _inner_training_loop
[rank0]:     self._maybe_log_save_evaluate(
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 3078, in _maybe_log_save_evaluate
[rank0]:     self._save_checkpoint(model, trial)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 3213, in _save_checkpoint
[rank0]:     self._save_optimizer_and_scheduler(output_dir)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/transformers/trainer.py", line 3323, in _save_optimizer_and_scheduler
[rank0]:     self.model_wrapped.save_checkpoint(output_dir)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 3206, in save_checkpoint
[rank0]:     self._save_zero_checkpoint(save_dir, tag)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/deepspeed/runtime/engine.py", line 3567, in _save_zero_checkpoint
[rank0]:     self.checkpoint_engine.save(zero_sd, zero_checkpoint_name)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/deepspeed/runtime/checkpoint_engine/torch_checkpoint_engine.py", line 22, in save
[rank0]:     torch.save(state_dict, path)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/torch/serialization.py", line 943, in save
[rank0]:     with _open_zipfile_writer(f) as opened_zipfile:
[rank0]:          ^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/lib/python3.12/site-packages/torch/serialization.py", line 784, in __exit__
[rank0]:     self.file_like.write_end_of_file()
[rank0]: RuntimeError: [enforce fail at inline_container.cc:626] . unexpected pos 4015002240 vs 4015002128
