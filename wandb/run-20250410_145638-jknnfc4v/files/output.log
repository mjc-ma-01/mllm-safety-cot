  0%|          | 0/4509 [00:00<?, ?it/s]Traceback (most recent call last):
> /mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py(2462)_inner_training_loop()
-> epoch_dataloader = train_dataloader
(Pdb) > /mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_vlm.py(172)multimodal_collator()
-> batch = processor(text=texts, images=images, return_tensors="pt", padding=True)
(Pdb) ["A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: <image>You are a helpful and harmless assistant.You are given an image and a question, please answer the question.\nQuestion: Write a detailed description of the given image.\n\n ASSISTANT: This image captures a moment from a safari tour in the world-renowned Serengeti National Park in Tanzania. The perspective is from a low angle, providing a ground-level view of the scene. A group of animals, native to the African savannah, have congregated around a watering hole, a vital resource in their habitat. Among them, a giraffe, one of the tallest mammals on Earth, is seen walking towards a safari vehicle parked nearby, perhaps curious about the visitors. The sky overhead is filled with clouds, casting a soft light over the scene. The colors in the image are predominantly earthy tones of brown and gray, reflecting the natural landscape of the Serengeti.</s>", "A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: <image>You are a helpful and harmless assistant.You are given an image and a question, please answer the question.\nQuestion: What do you see happening in this image?\n\n ASSISTANT: The image captures a Sony camera, colored in black and silver, perched on a black tripod. The camera is positioned in the foreground, with its lens directed towards a sprawling cityscape that stretches out in the background. The city is a vibrant mix of buildings, varying in color and size, creating a dynamic urban tapestry. The sky above is a clear blue, dotted with white clouds. The perspective of the image is from a high angle, looking down on the city, as if the viewer is sharing the camera's bird's eye view. The image does not provide any identifiable information about the specific landmark labeled as 'sa_15156'.</s>", "A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: <image>You are a helpful and harmless assistant.You are given an image and a question, please answer the question.\nQuestion: Describe the following image.\n<image>\n\n ASSISTANT: The image captures a bustling shopping mall, teeming with a variety of clothing stores. The mall's modern design is evident with its black and white striped ceiling and wooden flooring. \n\nDominating the center of the image is a clothing store, distinguished by its unique wooden exterior. A large glass window showcases mannequins adorned in vibrant clothing, offering a glimpse into the store's fashion offerings. \n\nTo the left, a woman is captured mid-stride, passing by a store. She is near a display featuring a pink and white floral dress, possibly indicating the store's spring collection. \n\nOn the right, a series of clothing stores come into view. Their windows are filled with colorful displays and mannequins dressed in a variety of styles, each store offering its own take on the latest fashion trends. \n\nThe image as a whole paints a picture of a typical day in a modern shopping mall, filled with activity and a wide array of shopping options.</s>", "A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: <image>You are a helpful and harmless assistant.You are given an image and a question, please answer the question.\nQuestion: Describe the following image.\n\n ASSISTANT: This image captures a serene scene at a rocky shore. In the foreground, a **black cormorant** is perched on a **gray, jagged rock**. The bird has its wings spread out, perhaps drying them after a dive into the water. The water surrounding the rock is calm and blue, reflecting the overcast gray sky above.\n\nIn the distance, on the horizon, stands a **white lighthouse**, a beacon of safety for seafarers. Its presence adds a sense of sca
(Pdb) "A chat between a curious user and an artificial intelligence assistant. The assistant gives helpful, detailed, and polite answers to the user's questions. USER: <image>You are a helpful and harmless assistant.You are given an image and a question, please answer the question.\nQuestion: What do you see happening in this image?\n\n ASSISTANT: The image captures a Sony camera, colored in black and silver, perched on a black tripod. The camera is positioned in the foreground, with its lens directed towards a sprawling cityscape that stretches out in the background. The city is a vibrant mix of buildings, varying in color and size, creating a dynamic urban tapestry. The sky above is a clear blue, dotted with white clouds. The perspective of the image is from a high angle, looking down on the city, as if the viewer is sharing the camera's bird's eye view. The image does not provide any identifiable information about the specific landmark labeled as 'sa_15156'.</s>"
(Pdb)
  File "/mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_vlm.py", line 240, in <module>
    trainer.train()
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2241, in train
    return inner_training_loop(
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2501, in _inner_training_loop
    for i, inputs in enumerate(batch_samples):
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 5185, in get_batch_samples
    # For now we don't support object detection
TypeError: argument of type 'NoneType' is not iterable
[rank0]: Traceback (most recent call last):
[rank0]:   File "/mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_vlm.py", line 240, in <module>
[rank0]:     trainer.train()
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2241, in train
[rank0]:     return inner_training_loop(
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2501, in _inner_training_loop
[rank0]:     for i, inputs in enumerate(batch_samples):
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 5185, in get_batch_samples
[rank0]:     # For now we don't support object detection
[rank0]: TypeError: argument of type 'NoneType' is not iterable
