  0%|          | 0/4509 [00:00<?, ?it/s]Traceback (most recent call last):
> /mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_vlm.py(166)multimodal_collator()
-> batch = processor(text=texts, images=images, return_tensors="pt", padding=True)
(Pdb) ['[INST] <image>\nYou are a helpful and harmless assistant.You are given an image and a question, please answer the question.\nQuestion: Explain the visual content of the image in great detail.\n\n [/INST] The image captures a lively scene of a group of people camping on a mountain top. The vantage point of the photo is high above the campsite, providing a bird\'s eye view of the colorful tents scattered across the landscape. The campers are seen moving around the site, engaging in various activities, adding a dynamic element to the otherwise serene setting.\n\nThe mountain peaks in the background rise majestically against the clear blue sky, creating a stunning contrast with the vibrant colors of the tents. The horizon line where the mountains meet the sky adds depth to the image, enhancing the sense of scale and grandeur of the landscape.\n\nThe overall mood of the photo is peaceful and serene, perfectly capturing the essence of a mountain camping adventure. The image does not provide any specific information about the landmark "sa_15414". However, the beauty of the scene and the joy of the campers suggest that it is a place of natural beauty and outdoor enjoyment.</s> ', "[INST] <image>\nYou are a helpful and harmless assistant.You are given an image and a question, please answer the question.\nQuestion: What do you think is going on in this snapshot?\n<image>\n\n [/INST] In the given image, a serene beach scene unfolds. The dominant feature is two vibrant umbrellas, each striped with a unique set of colors. One umbrella sports stripes of green, blue, and white, while the other is adorned with stripes of orange, blue, and white. These umbrellas are planted firmly in the sand, providing shade and adding a pop of color to the scene.\n\nNearby, a green chair invites relaxation. It's not just any chair - it's embellished with a red flower design that echoes the vibrancy of the umbrellas. A red bag sits next to the chair, perhaps containing beach essentials like sunscreen and a good book.\n\nA little distance away, a person is seen lying on a towel. The towel, like the umbrellas, is striped in blue and white, blending harmoniously with the overall color scheme of the beach scene. The person appears to be enjoying a peaceful nap under the warm sun.\n\nScattered around are a few more towels and bags, suggesting that there might be others enjoying this beautiful day at the beach. The backdrop of this scene is the vast ocean meeting a clear blue sky at the horizon, completing this idyllic beach setting.</s> ", "[INST] <image>\nYou are a helpful and harmless assistant.You are given an image and a question, please answer the question.\nQuestion: Can you describe the main features of this image for me?\n<image>\n\n [/INST] The image features a vibrant scene on a sunny day. At the forefront, there's a **yellow fire hydrant** situated on a grassy patch next to a sidewalk. The hydrant is not just a static object in this scene, it's quite active with water gushing out from it, creating a dynamic spectacle.\n\nBehind the hydrant, there's a signpost with a black arrow pointing to the right, perhaps indicating the direction of traffic or a particular destination. The signpost is located on the same grassy area as the fire hydrant.\n\nIn the background, you can see a parking lot with several cars parked. The cars and the parking lot are located beyond the sidewalk and grassy area where the fire hydrant and signpost are situated.\n\nAbove all these, the sky is beautifully clear with a bright blue color and is dotted with fluffy white clouds, adding to the overall serene atmosphere of the scene. The relative positions of these objects and their interactions create a lively and interesting snapshot of everyday life.</s> ", '[INST] <image>\nYou are a helpful and harmless assistant.You are given an image and a question, please answer the question.\nQuestion: Analyze the image in a comprehensive and detailed manner.\n\n [/INST] In the heart of a vibrant park, a dynamic game of frisbee unfolds. Two players, each adorned in jerseys as colo
(Pdb) [<PIL.Image.Image image mode=RGB size=2250x1500 at 0x7F743F635C30>, <PIL.Image.Image image mode=RGB size=640x480 at 0x7F743FF93AF0>, <PIL.Image.Image image mode=RGB size=640x428 at 0x7F743F634460>, <PIL.Image.Image image mode=RGB size=640x514 at 0x7F743FF929B0>]
(Pdb)
  File "/mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_vlm.py", line 232, in <module>
    trainer.train()
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2241, in train
    return inner_training_loop(
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2500, in _inner_training_loop
    batch_samples, num_items_in_batch = self.get_batch_samples(epoch_iterator, num_batches)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 5184, in get_batch_samples
    if len(batch_samples) > 0 and "labels" in batch_samples[0]:
TypeError: argument of type 'NoneType' is not iterable
[rank0]: Traceback (most recent call last):
[rank0]:   File "/mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_vlm.py", line 232, in <module>
[rank0]:     trainer.train()
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2241, in train
[rank0]:     return inner_training_loop(
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2500, in _inner_training_loop
[rank0]:     batch_samples, num_items_in_batch = self.get_batch_samples(epoch_iterator, num_batches)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 5184, in get_batch_samples
[rank0]:     if len(batch_samples) > 0 and "labels" in batch_samples[0]:
[rank0]: TypeError: argument of type 'NoneType' is not iterable
