  0%|          | 0/2256 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
                                                     
{'loss': 1.5489, 'grad_norm': 18.571914672851562, 'learning_rate': 1.9920212765957446e-05, 'mean_token_accuracy': 0.6160569489002228, 'epoch': 0.01}
{'loss': 1.5154, 'grad_norm': 16.13861656188965, 'learning_rate': 1.9831560283687945e-05, 'mean_token_accuracy': 0.6290417313575745, 'epoch': 0.03}
{'loss': 1.5212, 'grad_norm': 105.88390350341797, 'learning_rate': 1.974290780141844e-05, 'mean_token_accuracy': 0.6203703999519348, 'epoch': 0.04}
{'loss': 1.5356, 'grad_norm': 20.70493507385254, 'learning_rate': 1.965425531914894e-05, 'mean_token_accuracy': 0.6223603665828705, 'epoch': 0.05}
{'loss': 1.5026, 'grad_norm': 16.28217887878418, 'learning_rate': 1.9565602836879435e-05, 'mean_token_accuracy': 0.6246209979057312, 'epoch': 0.07}
{'loss': 1.5105, 'grad_norm': 15.7426118850708, 'learning_rate': 1.947695035460993e-05, 'mean_token_accuracy': 0.6239470303058624, 'epoch': 0.08}
{'loss': 1.469, 'grad_norm': 15.303888320922852, 'learning_rate': 1.9388297872340425e-05, 'mean_token_accuracy': 0.6378079414367676, 'epoch': 0.09}
{'loss': 1.5472, 'grad_norm': 13.78488826751709, 'learning_rate': 1.9299645390070924e-05, 'mean_token_accuracy': 0.6151104629039764, 'epoch': 0.11}
{'loss': 1.5293, 'grad_norm': 15.399673461914062, 'learning_rate': 1.921099290780142e-05, 'mean_token_accuracy': 0.6256389617919922, 'epoch': 0.12}
{'loss': 1.517, 'grad_norm': 13.616951942443848, 'learning_rate': 1.9122340425531915e-05, 'mean_token_accuracy': 0.6173033893108368, 'epoch': 0.13}
{'loss': 1.4985, 'grad_norm': 13.053406715393066, 'learning_rate': 1.9033687943262414e-05, 'mean_token_accuracy': 0.6290480613708496, 'epoch': 0.15}
{'loss': 1.4609, 'grad_norm': 14.565484046936035, 'learning_rate': 1.894503546099291e-05, 'mean_token_accuracy': 0.6364295065402985, 'epoch': 0.16}
{'loss': 1.402, 'grad_norm': 12.367570877075195, 'learning_rate': 1.8856382978723408e-05, 'mean_token_accuracy': 0.6466284036636353, 'epoch': 0.17}
{'loss': 1.4232, 'grad_norm': 15.302189826965332, 'learning_rate': 1.8767730496453903e-05, 'mean_token_accuracy': 0.6361649394035339, 'epoch': 0.19}
{'loss': 1.4309, 'grad_norm': 10.360553741455078, 'learning_rate': 1.86790780141844e-05, 'mean_token_accuracy': 0.6387221813201904, 'epoch': 0.2}
{'loss': 1.412, 'grad_norm': 12.173251152038574, 'learning_rate': 1.8590425531914894e-05, 'mean_token_accuracy': 0.6452445030212403, 'epoch': 0.21}
{'loss': 1.3247, 'grad_norm': 12.806585311889648, 'learning_rate': 1.850177304964539e-05, 'mean_token_accuracy': 0.6628463625907898, 'epoch': 0.23}
{'loss': 1.3073, 'grad_norm': 10.251107215881348, 'learning_rate': 1.841312056737589e-05, 'mean_token_accuracy': 0.6734680652618408, 'epoch': 0.24}
{'loss': 1.4074, 'grad_norm': 13.617063522338867, 'learning_rate': 1.8324468085106384e-05, 'mean_token_accuracy': 0.6447275757789612, 'epoch': 0.25}
{'loss': 1.4583, 'grad_norm': 14.5725736618042, 'learning_rate': 1.8235815602836883e-05, 'mean_token_accuracy': 0.6390449583530426, 'epoch': 0.27}
{'loss': 1.3, 'grad_norm': 11.464315414428711, 'learning_rate': 1.8147163120567378e-05, 'mean_token_accuracy': 0.6691779971122742, 'epoch': 0.28}
{'loss': 1.3323, 'grad_norm': 13.57254409790039, 'learning_rate': 1.8058510638297873e-05, 'mean_token_accuracy': 0.6696250021457673, 'epoch': 0.29}
{'loss': 1.4201, 'grad_norm': 13.008967399597168, 'learning_rate': 1.796985815602837e-05, 'mean_token_accuracy': 0.639835262298584, 'epoch': 0.31}
{'loss': 1.2582, 'grad_norm': 10.070003509521484, 'learning_rate': 1.7881205673758864e-05, 'mean_token_accuracy': 0.6714836001396179, 'epoch': 0.32}
{'loss': 1.2964, 'grad_norm': 10.906554222106934, 'learning_rate': 1.7792553191489363e-05, 'mean_token_accuracy': 0.6733957707881928, 'epoch': 0.33}
{'loss': 1.3826, 'grad_norm': 9.350587844848633, 'learning_rate': 1.770390070921986e-05, 'mean_token_accuracy': 0.6555820882320404, 'epoch': 0.35}
{'loss': 1.3022, 'grad_norm': 14.498880386352539, 'learning_rate': 1.7615248226950357e-05, 'mean_token_accuracy': 0.6702447295188904, 'epoch': 0.36}
{'loss': 1.2367, 'grad_norm': 11.820353507995605, 'learning_rate': 1.7526595744680853e-05, 'mean_token_accuracy': 0.6784233212471008, 'epoch': 0.37}
{'loss': 1.2372, 'grad_norm': 9.803884506225586, 'learning_rate': 1.743794326241135e-05, 'mean_token_accuracy': 0.6759836256504059, 'epoch': 0.39}
{'loss': 1.2955, 'grad_norm': 9.067407608032227, 'learning_rate': 1.7349290780141847e-05, 'mean_token_accuracy': 0.6654870688915253, 'epoch': 0.4}
{'loss': 1.2406, 'grad_norm': 9.700088500976562, 'learning_rate': 1.7260638297872342e-05, 'mean_token_accuracy': 0.6812478125095367, 'epoch': 0.41}
{'loss': 1.2084, 'grad_norm': 10.5327730178833, 'learning_rate': 1.7171985815602838e-05, 'mean_token_accuracy': 0.6859395384788514, 'epoch': 0.43}
{'loss': 1.2729, 'grad_norm': 11.305397033691406, 'learning_rate': 1.7083333333333333e-05, 'mean_token_accuracy': 0.6769440293312072, 'epoch': 0.44}
{'loss': 1.2347, 'grad_norm': 10.998029708862305, 'learning_rate': 1.6994680851063832e-05, 'mean_token_accuracy': 0.6782338082790375, 'epoch': 0.45}
{'loss': 1.3777, 'grad_norm': 11.132577896118164, 'learning_rate': 1.6906028368794327e-05, 'mean_token_accuracy': 0.6508879065513611, 'epoch': 0.47}
{'loss': 1.2753, 'grad_norm': 13.3424711227417, 'learning_rate': 1.6817375886524826e-05, 'mean_token_accuracy': 0.6703465819358826, 'epoch': 0.48}
{'loss': 1.2714, 'grad_norm': 10.744588851928711, 'learning_rate': 1.672872340425532e-05, 'mean_token_accuracy': 0.674009507894516, 'epoch': 0.49}
{'loss': 1.1543, 'grad_norm': 14.014719009399414, 'learning_rate': 1.6640070921985817e-05, 'mean_token_accuracy': 0.6934925854206085, 'epoch': 0.51}
{'loss': 1.2356, 'grad_norm': 10.926858901977539, 'learning_rate': 1.6551418439716312e-05, 'mean_token_accuracy': 0.6782465159893036, 'epoch': 0.52}
{'loss': 1.1824, 'grad_norm': 12.751791000366211, 'learning_rate': 1.6462765957446808e-05, 'mean_token_accuracy': 0.6978744983673095, 'epoch': 0.53}
{'loss': 1.2223, 'grad_norm': 10.254463195800781, 'learning_rate': 1.6374113475177306e-05, 'mean_token_accuracy': 0.6843432009220123, 'epoch': 0.55}
{'loss': 1.112, 'grad_norm': 17.465986251831055, 'learning_rate': 1.6285460992907802e-05, 'mean_token_accuracy': 0.7115440309047699, 'epoch': 0.56}
{'loss': 1.1518, 'grad_norm': 11.217041015625, 'learning_rate': 1.61968085106383e-05, 'mean_token_accuracy': 0.6979002773761749, 'epoch': 0.57}
{'loss': 1.1099, 'grad_norm': 10.284838676452637, 'learning_rate': 1.6108156028368796e-05, 'mean_token_accuracy': 0.7054852545261383, 'epoch': 0.59}
{'loss': 1.1471, 'grad_norm': 10.486105918884277, 'learning_rate': 1.6019503546099295e-05, 'mean_token_accuracy': 0.6973126888275146, 'epoch': 0.6}
{'loss': 1.2105, 'grad_norm': 10.117027282714844, 'learning_rate': 1.593085106382979e-05, 'mean_token_accuracy': 0.6856318533420562, 'epoch': 0.61}
{'loss': 1.1603, 'grad_norm': 11.3410005569458, 'learning_rate': 1.5842198581560286e-05, 'mean_token_accuracy': 0.6922484159469604, 'epoch': 0.62}
{'loss': 1.1126, 'grad_norm': 10.511151313781738, 'learning_rate': 1.575354609929078e-05, 'mean_token_accuracy': 0.7029922902584076, 'epoch': 0.64}
{'loss': 1.0894, 'grad_norm': 9.981940269470215, 'learning_rate': 1.5664893617021276e-05, 'mean_token_accuracy': 0.7169791758060455, 'epoch': 0.65}
{'loss': 1.2296, 'grad_norm': 10.830985069274902, 'learning_rate': 1.5576241134751775e-05, 'mean_token_accuracy': 0.6776873767375946, 'epoch': 0.66}
{'loss': 1.0964, 'grad_norm': 11.271120071411133, 'learning_rate': 1.548758865248227e-05, 'mean_token_accuracy': 0.7057313084602356, 'epoch': 0.68}
{'loss': 1.1119, 'grad_norm': 10.706110000610352, 'learning_rate': 1.539893617021277e-05, 'mean_token_accuracy': 0.7031658530235291, 'epoch': 0.69}
{'loss': 1.0171, 'grad_norm': 11.414725303649902, 'learning_rate': 1.5310283687943265e-05, 'mean_token_accuracy': 0.72292400598526, 'epoch': 0.7}
{'loss': 1.1374, 'grad_norm': 10.917362213134766, 'learning_rate': 1.5221631205673758e-05, 'mean_token_accuracy': 0.7093880414962769, 'epoch': 0.72}
{'loss': 1.1785, 'grad_norm': 17.93058967590332, 'learning_rate': 1.5132978723404257e-05, 'mean_token_accuracy': 0.698015832901001, 'epoch': 0.73}
{'loss': 1.0875, 'grad_norm': 10.775308609008789, 'learning_rate': 1.5044326241134753e-05, 'mean_token_accuracy': 0.721282285451889, 'epoch': 0.74}
{'loss': 1.1601, 'grad_norm': 10.930229187011719, 'learning_rate': 1.495567375886525e-05, 'mean_token_accuracy': 0.6911782264709473, 'epoch': 0.76}
{'loss': 1.1163, 'grad_norm': 10.544386863708496, 'learning_rate': 1.4867021276595745e-05, 'mean_token_accuracy': 0.700291657447815, 'epoch': 0.77}
{'loss': 1.0165, 'grad_norm': 11.653526306152344, 'learning_rate': 1.4778368794326244e-05, 'mean_token_accuracy': 0.7293699622154236, 'epoch': 0.78}
{'loss': 1.0155, 'grad_norm': 11.753859519958496, 'learning_rate': 1.468971631205674e-05, 'mean_token_accuracy': 0.7241919875144959, 'epoch': 0.8}
{'loss': 1.0941, 'grad_norm': 7.849772930145264, 'learning_rate': 1.4601063829787235e-05, 'mean_token_accuracy': 0.7078694880008698, 'epoch': 0.81}
{'loss': 1.0739, 'grad_norm': 10.719036102294922, 'learning_rate': 1.4512411347517732e-05, 'mean_token_accuracy': 0.7155886471271515, 'epoch': 0.82}
{'loss': 0.9688, 'grad_norm': 10.729782104492188, 'learning_rate': 1.4423758865248227e-05, 'mean_token_accuracy': 0.7450410842895507, 'epoch': 0.84}
{'loss': 0.9788, 'grad_norm': 11.279194831848145, 'learning_rate': 1.4335106382978724e-05, 'mean_token_accuracy': 0.7403894007205963, 'epoch': 0.85}
{'loss': 1.008, 'grad_norm': 12.022573471069336, 'learning_rate': 1.424645390070922e-05, 'mean_token_accuracy': 0.7314907610416412, 'epoch': 0.86}
{'loss': 0.8174, 'grad_norm': 11.943778991699219, 'learning_rate': 1.4157801418439719e-05, 'mean_token_accuracy': 0.7647722005844116, 'epoch': 0.88}
{'loss': 0.9655, 'grad_norm': 9.072092056274414, 'learning_rate': 1.4069148936170214e-05, 'mean_token_accuracy': 0.7286697328090668, 'epoch': 0.89}
{'loss': 0.9945, 'grad_norm': 8.855559349060059, 'learning_rate': 1.398049645390071e-05, 'mean_token_accuracy': 0.7299998164176941, 'epoch': 0.9}
{'loss': 0.9219, 'grad_norm': 10.591879844665527, 'learning_rate': 1.3891843971631206e-05, 'mean_token_accuracy': 0.7441598355770112, 'epoch': 0.92}
{'loss': 0.9583, 'grad_norm': 8.468216896057129, 'learning_rate': 1.3803191489361702e-05, 'mean_token_accuracy': 0.7365652918815613, 'epoch': 0.93}
{'loss': 0.9711, 'grad_norm': 11.874251365661621, 'learning_rate': 1.37145390070922e-05, 'mean_token_accuracy': 0.7394960939884185, 'epoch': 0.94}
{'loss': 0.9439, 'grad_norm': 16.364864349365234, 'learning_rate': 1.3625886524822696e-05, 'mean_token_accuracy': 0.7471470594406128, 'epoch': 0.96}
{'loss': 0.9446, 'grad_norm': 8.743704795837402, 'learning_rate': 1.3537234042553193e-05, 'mean_token_accuracy': 0.7457712054252624, 'epoch': 0.97}
{'loss': 0.8359, 'grad_norm': 7.57259464263916, 'learning_rate': 1.3448581560283689e-05, 'mean_token_accuracy': 0.7647011280059814, 'epoch': 0.98}
{'loss': 0.9833, 'grad_norm': 10.019083976745605, 'learning_rate': 1.3359929078014187e-05, 'mean_token_accuracy': 0.7398403525352478, 'epoch': 1.0}
{'loss': 0.8912, 'grad_norm': 14.327707290649414, 'learning_rate': 1.3271276595744683e-05, 'mean_token_accuracy': 0.7519938051700592, 'epoch': 1.01}
{'loss': 0.8574, 'grad_norm': 7.949719429016113, 'learning_rate': 1.3182624113475178e-05, 'mean_token_accuracy': 0.7638827562332153, 'epoch': 1.02}
{'loss': 0.8526, 'grad_norm': 8.416117668151855, 'learning_rate': 1.3093971631205675e-05, 'mean_token_accuracy': 0.7676894128322601, 'epoch': 1.04}
{'loss': 0.8803, 'grad_norm': 8.777034759521484, 'learning_rate': 1.300531914893617e-05, 'mean_token_accuracy': 0.7526933908462524, 'epoch': 1.05}
{'loss': 0.8166, 'grad_norm': 9.049195289611816, 'learning_rate': 1.2916666666666668e-05, 'mean_token_accuracy': 0.7746904790401459, 'epoch': 1.06}
{'loss': 0.8339, 'grad_norm': 7.906965732574463, 'learning_rate': 1.2828014184397163e-05, 'mean_token_accuracy': 0.7679426908493042, 'epoch': 1.08}
{'loss': 0.7717, 'grad_norm': 8.044392585754395, 'learning_rate': 1.2739361702127662e-05, 'mean_token_accuracy': 0.7764093279838562, 'epoch': 1.09}
{'loss': 0.778, 'grad_norm': 9.205246925354004, 'learning_rate': 1.2650709219858157e-05, 'mean_token_accuracy': 0.7756470561027526, 'epoch': 1.1}
{'loss': 0.8545, 'grad_norm': 9.408464431762695, 'learning_rate': 1.2562056737588653e-05, 'mean_token_accuracy': 0.7613748610019684, 'epoch': 1.12}
{'loss': 0.7955, 'grad_norm': 7.709345817565918, 'learning_rate': 1.247340425531915e-05, 'mean_token_accuracy': 0.7811273813247681, 'epoch': 1.13}
{'loss': 0.7271, 'grad_norm': 8.669260025024414, 'learning_rate': 1.2384751773049645e-05, 'mean_token_accuracy': 0.7928176045417785, 'epoch': 1.14}
{'loss': 0.8682, 'grad_norm': 8.313959121704102, 'learning_rate': 1.2296099290780144e-05, 'mean_token_accuracy': 0.7683699727058411, 'epoch': 1.16}
{'loss': 0.7609, 'grad_norm': 10.46267032623291, 'learning_rate': 1.220744680851064e-05, 'mean_token_accuracy': 0.7964430510997772, 'epoch': 1.17}
{'loss': 0.8172, 'grad_norm': 8.17695140838623, 'learning_rate': 1.2118794326241137e-05, 'mean_token_accuracy': 0.7836671650409699, 'epoch': 1.18}
{'loss': 0.7903, 'grad_norm': 8.579218864440918, 'learning_rate': 1.2030141843971632e-05, 'mean_token_accuracy': 0.7748223841190338, 'epoch': 1.2}
{'loss': 0.8016, 'grad_norm': 8.970364570617676, 'learning_rate': 1.1941489361702127e-05, 'mean_token_accuracy': 0.7753195643424988, 'epoch': 1.21}
{'loss': 0.6712, 'grad_norm': 7.91328239440918, 'learning_rate': 1.1852836879432626e-05, 'mean_token_accuracy': 0.8133944869041443, 'epoch': 1.22}
{'loss': 0.7257, 'grad_norm': 7.46754264831543, 'learning_rate': 1.1764184397163122e-05, 'mean_token_accuracy': 0.7989466488361359, 'epoch': 1.24}
{'loss': 0.7929, 'grad_norm': 8.509688377380371, 'learning_rate': 1.1675531914893619e-05, 'mean_token_accuracy': 0.7718767106533051, 'epoch': 1.25}
{'loss': 0.6705, 'grad_norm': 8.371318817138672, 'learning_rate': 1.1586879432624114e-05, 'mean_token_accuracy': 0.8082490682601928, 'epoch': 1.26}
{'loss': 0.7808, 'grad_norm': 9.217364311218262, 'learning_rate': 1.1498226950354611e-05, 'mean_token_accuracy': 0.7882873117923737, 'epoch': 1.28}
{'loss': 0.7264, 'grad_norm': 10.471179008483887, 'learning_rate': 1.1409574468085107e-05, 'mean_token_accuracy': 0.7954701960086823, 'epoch': 1.29}
{'loss': 0.7528, 'grad_norm': 8.391054153442383, 'learning_rate': 1.1320921985815602e-05, 'mean_token_accuracy': 0.7883468210697174, 'epoch': 1.3}
{'loss': 0.7281, 'grad_norm': 9.703304290771484, 'learning_rate': 1.12322695035461e-05, 'mean_token_accuracy': 0.7937966704368591, 'epoch': 1.32}
{'loss': 0.7173, 'grad_norm': 7.870038986206055, 'learning_rate': 1.1143617021276596e-05, 'mean_token_accuracy': 0.7922753393650055, 'epoch': 1.33}
{'loss': 0.8071, 'grad_norm': 11.209945678710938, 'learning_rate': 1.1054964539007093e-05, 'mean_token_accuracy': 0.771944671869278, 'epoch': 1.34}
{'loss': 0.7233, 'grad_norm': 9.142155647277832, 'learning_rate': 1.0966312056737589e-05, 'mean_token_accuracy': 0.7890231370925903, 'epoch': 1.36}
{'loss': 0.6843, 'grad_norm': 8.88725757598877, 'learning_rate': 1.0877659574468088e-05, 'mean_token_accuracy': 0.7983064234256745, 'epoch': 1.37}
{'loss': 0.7068, 'grad_norm': 6.8062968254089355, 'learning_rate': 1.0789007092198583e-05, 'mean_token_accuracy': 0.7903062701225281, 'epoch': 1.38}
{'loss': 0.5807, 'grad_norm': 5.716921806335449, 'learning_rate': 1.0700354609929078e-05, 'mean_token_accuracy': 0.8395084798336029, 'epoch': 1.4}
{'loss': 0.711, 'grad_norm': 7.967127799987793, 'learning_rate': 1.0611702127659575e-05, 'mean_token_accuracy': 0.8065240144729614, 'epoch': 1.41}
{'loss': 0.6994, 'grad_norm': 8.436849594116211, 'learning_rate': 1.052304964539007e-05, 'mean_token_accuracy': 0.8052725613117218, 'epoch': 1.42}
{'loss': 0.6079, 'grad_norm': 8.318623542785645, 'learning_rate': 1.0434397163120568e-05, 'mean_token_accuracy': 0.8208315908908844, 'epoch': 1.44}
{'loss': 0.6244, 'grad_norm': 8.550192832946777, 'learning_rate': 1.0345744680851065e-05, 'mean_token_accuracy': 0.8186414837837219, 'epoch': 1.45}
{'loss': 0.6837, 'grad_norm': 7.826909065246582, 'learning_rate': 1.0257092198581562e-05, 'mean_token_accuracy': 0.8085220336914063, 'epoch': 1.46}
{'loss': 0.6288, 'grad_norm': 6.3107991218566895, 'learning_rate': 1.0168439716312058e-05, 'mean_token_accuracy': 0.8217244386672974, 'epoch': 1.48}
{'loss': 0.581, 'grad_norm': 7.69865083694458, 'learning_rate': 1.0079787234042555e-05, 'mean_token_accuracy': 0.8331975936889648, 'epoch': 1.49}
{'loss': 0.5927, 'grad_norm': 8.16991138458252, 'learning_rate': 9.99113475177305e-06, 'mean_token_accuracy': 0.8272168159484863, 'epoch': 1.5}
{'loss': 0.5912, 'grad_norm': 8.371554374694824, 'learning_rate': 9.902482269503547e-06, 'mean_token_accuracy': 0.830600517988205, 'epoch': 1.52}
{'loss': 0.6549, 'grad_norm': 11.065299034118652, 'learning_rate': 9.813829787234044e-06, 'mean_token_accuracy': 0.8149752974510193, 'epoch': 1.53}
{'loss': 0.6637, 'grad_norm': 9.350449562072754, 'learning_rate': 9.72517730496454e-06, 'mean_token_accuracy': 0.8019572615623474, 'epoch': 1.54}
{'loss': 0.6713, 'grad_norm': 10.323155403137207, 'learning_rate': 9.636524822695035e-06, 'mean_token_accuracy': 0.8140552580356598, 'epoch': 1.56}
{'loss': 0.5915, 'grad_norm': 7.355104923248291, 'learning_rate': 9.547872340425532e-06, 'mean_token_accuracy': 0.8356675922870636, 'epoch': 1.57}
{'loss': 0.6266, 'grad_norm': 6.605016708374023, 'learning_rate': 9.45921985815603e-06, 'mean_token_accuracy': 0.8270972549915314, 'epoch': 1.58}
{'loss': 0.6057, 'grad_norm': 7.2308855056762695, 'learning_rate': 9.370567375886526e-06, 'mean_token_accuracy': 0.8222098171710968, 'epoch': 1.6}
{'loss': 0.6101, 'grad_norm': 8.267003059387207, 'learning_rate': 9.281914893617022e-06, 'mean_token_accuracy': 0.8391151666641236, 'epoch': 1.61}
  File "/mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_vlm_cot_.py", line 258, in <module>
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2245, in train
    return inner_training_loop(
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2560, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 3782, in training_step
    self.accelerator.backward(loss, **kwargs)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/accelerate/accelerator.py", line 2238, in backward
    self.deepspeed_engine_wrapped.backward(loss, **kwargs)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/accelerate/utils/deepspeed.py", line 261, in backward
    self.engine.backward(loss, **kwargs)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
    ret_val = func(*args, **kwargs)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/deepspeed/runtime/engine.py", line 2053, in backward
    self.optimizer.backward(loss, retain_graph=retain_graph)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 2062, in backward
    self.loss_scaler.backward(loss.float(), retain_graph=retain_graph)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/deepspeed/runtime/fp16/loss_scaler.py", line 63, in backward
    scaled_loss.backward(retain_graph=retain_graph)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_vlm_cot_.py", line 258, in <module>
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2245, in train
[rank0]:     return inner_training_loop(
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2560, in _inner_training_loop
[rank0]:     tr_loss_step = self.training_step(model, inputs, num_items_in_batch)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 3782, in training_step
[rank0]:     self.accelerator.backward(loss, **kwargs)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/accelerate/accelerator.py", line 2238, in backward
[rank0]:     self.deepspeed_engine_wrapped.backward(loss, **kwargs)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/accelerate/utils/deepspeed.py", line 261, in backward
[rank0]:     self.engine.backward(loss, **kwargs)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/deepspeed/utils/nvtx.py", line 18, in wrapped_fn
[rank0]:     ret_val = func(*args, **kwargs)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/deepspeed/runtime/engine.py", line 2053, in backward
[rank0]:     self.optimizer.backward(loss, retain_graph=retain_graph)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py", line 2062, in backward
[rank0]:     self.loss_scaler.backward(loss.float(), retain_graph=retain_graph)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/deepspeed/runtime/fp16/loss_scaler.py", line 63, in backward
[rank0]:     scaled_loss.backward(retain_graph=retain_graph)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/torch/_tensor.py", line 581, in backward
[rank0]:     torch.autograd.backward(
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/torch/autograd/__init__.py", line 347, in backward
[rank0]:     _engine_run_backward(
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
[rank0]:     return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]: KeyboardInterrupt
