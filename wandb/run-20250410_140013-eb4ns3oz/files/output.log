  0%|          | 0/4509 [00:00<?, ?it/s]Traceback (most recent call last):
> /mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_vlm.py(166)multimodal_collator()
-> batch = processor(text=texts, images=images, return_tensors="pt", padding=True)
(Pdb) (Pdb) ["[INST] <image>\nYou are a helpful and harmless assistant.You are given an image and a question, please answer the question.\nQuestion: What is this photo about'?\n\n [/INST] The image captures the grandeur of the Gyeongbokgung Palace, a significant landmark located in Seoul, South Korea. The palace, an epitome of traditional Korean architecture, stands majestically with its green and red roofs, white walls, and sturdy wooden pillars. The structure is surrounded by a vast courtyard, its ground covered in dirt, offering a stark contrast to the vibrancy of the palace. In the distance, a mountain with a rocky peak looms, adding a touch of nature's magnificence to the scene. The sky above is a clear blue, devoid of any clouds. The perspective of the photo is such that it's taken from a distance, encapsulating not just the palace in its entirety but also the mountain in the backdrop, providing a comprehensive view of this historical site. The identifier 'sa_16375' could possibly be a reference to the specific angle or viewpoint from which this photo was taken.</s> ", '[INST] <image>\nYou are a helpful and harmless assistant.You are given an image and a question, please answer the question.\nQuestion: What are the key elements in this picture?\n<image>\n\n [/INST] The image captures a vibrant soccer match in progress. The player in the foreground, donned in a red jersey with the number 16, is skillfully dribbling the ball. His focus is intense, reflecting the high stakes of the game. A player from the opposing team, wearing a blue and white striped jersey, is in hot pursuit, running towards the ball with determination. The stadium forms an impressive backdrop, filled with a sea of spectators whose excitement is almost palpable. Above, the sky is a clear blue, adding to the electrifying atmosphere of the match. The image is a dynamic snapshot of the thrilling world of soccer, encapsulating the passion, skill, and competitive spirit of the sport. As for the landmark, I\'m sorry but I couldn\'t find any information related to the code "sa_16235". It might be helpful to provide more context or details.</s> ', "[INST] <image>\nYou are a helpful and harmless assistant.You are given an image and a question, please answer the question.\nQuestion: What do you see happening in this image?\n\n [/INST] This image captures a moment of camaraderie and warmth amidst a chilly setting. Here's a detailed description:\n\n- **Six individuals** are the main subjects of this image, although only **four** are fully visible. They are huddled together on the ground, their bodies adorned in **winter clothing** and hats, suggesting a cold environment.\n- The ground beneath them is not bare but covered in various **blankets** and **bags**, providing some insulation against the cold. The colors of these items vary, adding a splash of vibrancy to the scene.\n- In the immediate foreground, there are **two bottles of water** and a **red bag**, possibly containing food or additional supplies.\n- The background presents an urban setting with a **building** and **trees** lining a street. This suggests that the group might be in a city or town.\n\nThe image exudes a sense of community and resilience, as these individuals find comfort in each other's company amidst the cold. It's a snapshot of life that speaks volumes about human connection and survival.</s> ", "[INST] <image>\nYou are a helpful and harmless assistant.You are given an image and a question, please answer the question.\nQuestion: What are the key elements in this picture?\n\n [/INST] This image captures a vibrant scene on a snowy mountain. There are **8 people** in total, all decked out in colorful winter attire, adding a splash of color to the white landscape. \n\nSix of them are mid-air, showcasing their skiing and snowboarding skills with impressive tricks. Their dynamic poses suggest a sense of motion and excitement. The remaining two are on the ground, perhaps preparing for their own jumps or watching their friends' daring stunts.\n\nThe mountain itself is blanketed in a thick lay
(Pdb) "[INST] <image>\nYou are a helpful and harmless assistant.You are given an image and a question, please answer the question.\nQuestion: What is this photo about'?\n\n [/INST] The image captures the grandeur of the Gyeongbokgung Palace, a significant landmark located in Seoul, South Korea. The palace, an epitome of traditional Korean architecture, stands majestically with its green and red roofs, white walls, and sturdy wooden pillars. The structure is surrounded by a vast courtyard, its ground covered in dirt, offering a stark contrast to the vibrancy of the palace. In the distance, a mountain with a rocky peak looms, adding a touch of nature's magnificence to the scene. The sky above is a clear blue, devoid of any clouds. The perspective of the photo is such that it's taken from a distance, encapsulating not just the palace in its entirety but also the mountain in the backdrop, providing a comprehensive view of this historical site. The identifier 'sa_16375' could possibly be a reference to the specific angle or viewpoint from which this photo was taken.</s> "
(Pdb) [[<PIL.Image.Image image mode=RGB size=2250x1500 at 0x7F4A55EDDBA0>], [<PIL.Image.Image image mode=RGB size=2254x1500 at 0x7F4A55EDDB70>], [<PIL.Image.Image image mode=RGB size=610x427 at 0x7F4A55EDDA20>], [<PIL.Image.Image image mode=RGB size=640x465 at 0x7F4A55E31180>]]
(Pdb)
  File "/mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_vlm.py", line 234, in <module>
    trainer.train()
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2241, in train
    return inner_training_loop(
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2500, in _inner_training_loop
    batch_samples, num_items_in_batch = self.get_batch_samples(epoch_iterator, num_batches)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 5184, in get_batch_samples
    if len(batch_samples) > 0 and "labels" in batch_samples[0]:
TypeError: argument of type 'NoneType' is not iterable
[rank0]: Traceback (most recent call last):
[rank0]:   File "/mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_vlm.py", line 234, in <module>
[rank0]:     trainer.train()
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2241, in train
[rank0]:     return inner_training_loop(
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2500, in _inner_training_loop
[rank0]:     batch_samples, num_items_in_batch = self.get_batch_samples(epoch_iterator, num_batches)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 5184, in get_batch_samples
[rank0]:     if len(batch_samples) > 0 and "labels" in batch_samples[0]:
[rank0]: TypeError: argument of type 'NoneType' is not iterable
