  0%|          | 0/2256 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
                                                     
{'loss': 1.7372, 'grad_norm': 27.340314865112305, 'learning_rate': 1.9920212765957446e-05, 'mean_token_accuracy': 0.6035043090581894, 'epoch': 0.01}
{'loss': 1.4661, 'grad_norm': 31.32973861694336, 'learning_rate': 1.9831560283687945e-05, 'mean_token_accuracy': 0.6232543170452118, 'epoch': 0.03}
{'loss': 1.5488, 'grad_norm': 17.733821868896484, 'learning_rate': 1.974290780141844e-05, 'mean_token_accuracy': 0.6101691007614136, 'epoch': 0.04}
{'loss': 1.3182, 'grad_norm': 17.616783142089844, 'learning_rate': 1.965425531914894e-05, 'mean_token_accuracy': 0.6384369134902954, 'epoch': 0.05}
{'loss': 1.2955, 'grad_norm': 13.728591918945312, 'learning_rate': 1.9565602836879435e-05, 'mean_token_accuracy': 0.6423888444900513, 'epoch': 0.07}
{'loss': 1.4119, 'grad_norm': 13.56472396850586, 'learning_rate': 1.947695035460993e-05, 'mean_token_accuracy': 0.6283602297306061, 'epoch': 0.08}
{'loss': 1.2877, 'grad_norm': 14.493206977844238, 'learning_rate': 1.9388297872340425e-05, 'mean_token_accuracy': 0.6490936577320099, 'epoch': 0.09}
{'loss': 1.3282, 'grad_norm': 12.60965347290039, 'learning_rate': 1.9299645390070924e-05, 'mean_token_accuracy': 0.642577737569809, 'epoch': 0.11}
{'loss': 1.3053, 'grad_norm': 16.028583526611328, 'learning_rate': 1.921099290780142e-05, 'mean_token_accuracy': 0.6339188694953919, 'epoch': 0.12}
{'loss': 1.3233, 'grad_norm': 11.283536911010742, 'learning_rate': 1.9122340425531915e-05, 'mean_token_accuracy': 0.6427150785923004, 'epoch': 0.13}
{'loss': 1.3217, 'grad_norm': 10.278179168701172, 'learning_rate': 1.9033687943262414e-05, 'mean_token_accuracy': 0.6495469868183136, 'epoch': 0.15}
{'loss': 1.1959, 'grad_norm': 10.918829917907715, 'learning_rate': 1.894503546099291e-05, 'mean_token_accuracy': 0.6583316922187805, 'epoch': 0.16}
{'loss': 1.2804, 'grad_norm': 12.974898338317871, 'learning_rate': 1.8856382978723408e-05, 'mean_token_accuracy': 0.6441484749317169, 'epoch': 0.17}
{'loss': 1.1661, 'grad_norm': 14.013322830200195, 'learning_rate': 1.8767730496453903e-05, 'mean_token_accuracy': 0.6524514436721802, 'epoch': 0.19}
{'loss': 1.2014, 'grad_norm': 14.125207901000977, 'learning_rate': 1.86790780141844e-05, 'mean_token_accuracy': 0.651955783367157, 'epoch': 0.2}
{'loss': 1.2315, 'grad_norm': 10.375102996826172, 'learning_rate': 1.8590425531914894e-05, 'mean_token_accuracy': 0.657262098789215, 'epoch': 0.21}
{'loss': 1.2172, 'grad_norm': 10.663092613220215, 'learning_rate': 1.850177304964539e-05, 'mean_token_accuracy': 0.6453601360321045, 'epoch': 0.23}
{'loss': 1.1041, 'grad_norm': 17.59055519104004, 'learning_rate': 1.841312056737589e-05, 'mean_token_accuracy': 0.6714116871356964, 'epoch': 0.24}
{'loss': 1.1969, 'grad_norm': 11.64212417602539, 'learning_rate': 1.8324468085106384e-05, 'mean_token_accuracy': 0.6471917152404785, 'epoch': 0.25}
{'loss': 1.1825, 'grad_norm': 11.366741180419922, 'learning_rate': 1.8235815602836883e-05, 'mean_token_accuracy': 0.6704665899276734, 'epoch': 0.27}
{'loss': 1.1466, 'grad_norm': 12.641945838928223, 'learning_rate': 1.8147163120567378e-05, 'mean_token_accuracy': 0.6760751485824585, 'epoch': 0.28}
{'loss': 1.1151, 'grad_norm': 14.32304859161377, 'learning_rate': 1.8058510638297873e-05, 'mean_token_accuracy': 0.6619497299194336, 'epoch': 0.29}
{'loss': 1.0645, 'grad_norm': 12.137630462646484, 'learning_rate': 1.796985815602837e-05, 'mean_token_accuracy': 0.671631270647049, 'epoch': 0.31}
{'loss': 1.1153, 'grad_norm': 10.318140983581543, 'learning_rate': 1.7881205673758864e-05, 'mean_token_accuracy': 0.6767390608787537, 'epoch': 0.32}
{'loss': 1.0585, 'grad_norm': 9.81786060333252, 'learning_rate': 1.7792553191489363e-05, 'mean_token_accuracy': 0.6976030111312866, 'epoch': 0.33}
{'loss': 1.2095, 'grad_norm': 11.327589988708496, 'learning_rate': 1.770390070921986e-05, 'mean_token_accuracy': 0.664908629655838, 'epoch': 0.35}
{'loss': 0.9036, 'grad_norm': 9.151735305786133, 'learning_rate': 1.7615248226950357e-05, 'mean_token_accuracy': 0.7062002956867218, 'epoch': 0.36}
{'loss': 1.0497, 'grad_norm': 10.225284576416016, 'learning_rate': 1.7526595744680853e-05, 'mean_token_accuracy': 0.685326099395752, 'epoch': 0.37}
{'loss': 1.1471, 'grad_norm': 8.680083274841309, 'learning_rate': 1.743794326241135e-05, 'mean_token_accuracy': 0.6589113473892212, 'epoch': 0.39}
{'loss': 1.1275, 'grad_norm': 10.153468132019043, 'learning_rate': 1.7349290780141847e-05, 'mean_token_accuracy': 0.680214011669159, 'epoch': 0.4}
{'loss': 1.0413, 'grad_norm': 10.401947975158691, 'learning_rate': 1.7260638297872342e-05, 'mean_token_accuracy': 0.6925754904747009, 'epoch': 0.41}
{'loss': 1.0901, 'grad_norm': 13.666952133178711, 'learning_rate': 1.7171985815602838e-05, 'mean_token_accuracy': 0.6867204487323761, 'epoch': 0.43}
{'loss': 0.9297, 'grad_norm': 8.806591033935547, 'learning_rate': 1.7083333333333333e-05, 'mean_token_accuracy': 0.70563924908638, 'epoch': 0.44}
{'loss': 1.0462, 'grad_norm': 15.85508918762207, 'learning_rate': 1.6994680851063832e-05, 'mean_token_accuracy': 0.6967126369476319, 'epoch': 0.45}
{'loss': 0.9746, 'grad_norm': 8.955839157104492, 'learning_rate': 1.6906028368794327e-05, 'mean_token_accuracy': 0.7011260151863098, 'epoch': 0.47}
{'loss': 1.0676, 'grad_norm': 13.151158332824707, 'learning_rate': 1.6817375886524826e-05, 'mean_token_accuracy': 0.679380476474762, 'epoch': 0.48}
{'loss': 1.0527, 'grad_norm': 6.540274143218994, 'learning_rate': 1.672872340425532e-05, 'mean_token_accuracy': 0.673567396402359, 'epoch': 0.49}
{'loss': 0.9367, 'grad_norm': 9.657994270324707, 'learning_rate': 1.6640070921985817e-05, 'mean_token_accuracy': 0.7079422831535339, 'epoch': 0.51}
{'loss': 0.9829, 'grad_norm': 8.335748672485352, 'learning_rate': 1.6551418439716312e-05, 'mean_token_accuracy': 0.7013882637023926, 'epoch': 0.52}
{'loss': 0.9415, 'grad_norm': 7.704568386077881, 'learning_rate': 1.6462765957446808e-05, 'mean_token_accuracy': 0.6984305262565613, 'epoch': 0.53}
{'loss': 1.0524, 'grad_norm': 9.696844100952148, 'learning_rate': 1.6374113475177306e-05, 'mean_token_accuracy': 0.6969325959682464, 'epoch': 0.55}
{'loss': 0.8645, 'grad_norm': 6.413422107696533, 'learning_rate': 1.6285460992907802e-05, 'mean_token_accuracy': 0.7266863942146301, 'epoch': 0.56}
{'loss': 0.9251, 'grad_norm': 8.966526985168457, 'learning_rate': 1.61968085106383e-05, 'mean_token_accuracy': 0.7163594603538513, 'epoch': 0.57}
{'loss': 1.0182, 'grad_norm': 9.480031967163086, 'learning_rate': 1.6108156028368796e-05, 'mean_token_accuracy': 0.6929959952831268, 'epoch': 0.59}
{'loss': 1.0956, 'grad_norm': 8.876212120056152, 'learning_rate': 1.6019503546099295e-05, 'mean_token_accuracy': 0.6900697708129883, 'epoch': 0.6}
{'loss': 0.9879, 'grad_norm': 6.87214994430542, 'learning_rate': 1.593085106382979e-05, 'mean_token_accuracy': 0.6995810747146607, 'epoch': 0.61}
{'loss': 0.8467, 'grad_norm': 8.090982437133789, 'learning_rate': 1.5842198581560286e-05, 'mean_token_accuracy': 0.716485857963562, 'epoch': 0.62}
{'loss': 0.8944, 'grad_norm': 9.255546569824219, 'learning_rate': 1.575354609929078e-05, 'mean_token_accuracy': 0.7323706686496735, 'epoch': 0.64}
{'loss': 0.8848, 'grad_norm': 5.904356479644775, 'learning_rate': 1.5664893617021276e-05, 'mean_token_accuracy': 0.7240037560462952, 'epoch': 0.65}
{'loss': 0.9406, 'grad_norm': 8.029706001281738, 'learning_rate': 1.5576241134751775e-05, 'mean_token_accuracy': 0.7055776178836822, 'epoch': 0.66}
{'loss': 0.941, 'grad_norm': 9.352531433105469, 'learning_rate': 1.548758865248227e-05, 'mean_token_accuracy': 0.7194226205348968, 'epoch': 0.68}
{'loss': 0.8425, 'grad_norm': 7.371096611022949, 'learning_rate': 1.539893617021277e-05, 'mean_token_accuracy': 0.7410488665103913, 'epoch': 0.69}
{'loss': 0.8767, 'grad_norm': 5.5690178871154785, 'learning_rate': 1.5310283687943265e-05, 'mean_token_accuracy': 0.728328961133957, 'epoch': 0.7}
{'loss': 0.8089, 'grad_norm': 6.682562828063965, 'learning_rate': 1.5221631205673758e-05, 'mean_token_accuracy': 0.7407751262187958, 'epoch': 0.72}
{'loss': 0.8391, 'grad_norm': 7.764479637145996, 'learning_rate': 1.5132978723404257e-05, 'mean_token_accuracy': 0.7206171929836274, 'epoch': 0.73}
{'loss': 0.9224, 'grad_norm': 9.477201461791992, 'learning_rate': 1.5044326241134753e-05, 'mean_token_accuracy': 0.7223229110240936, 'epoch': 0.74}
{'loss': 0.8593, 'grad_norm': 7.987017631530762, 'learning_rate': 1.495567375886525e-05, 'mean_token_accuracy': 0.724951446056366, 'epoch': 0.76}
{'loss': 0.9208, 'grad_norm': 7.272770404815674, 'learning_rate': 1.4867021276595745e-05, 'mean_token_accuracy': 0.726285433769226, 'epoch': 0.77}
{'loss': 0.8366, 'grad_norm': 10.041289329528809, 'learning_rate': 1.4778368794326244e-05, 'mean_token_accuracy': 0.7377782762050629, 'epoch': 0.78}
{'loss': 0.8399, 'grad_norm': 15.439657211303711, 'learning_rate': 1.468971631205674e-05, 'mean_token_accuracy': 0.7420868337154388, 'epoch': 0.8}
{'loss': 0.8028, 'grad_norm': 10.854257583618164, 'learning_rate': 1.4601063829787235e-05, 'mean_token_accuracy': 0.7399402022361755, 'epoch': 0.81}
{'loss': 0.6539, 'grad_norm': 10.362815856933594, 'learning_rate': 1.4512411347517732e-05, 'mean_token_accuracy': 0.7744620561599731, 'epoch': 0.82}
{'loss': 0.8617, 'grad_norm': 11.539387702941895, 'learning_rate': 1.4423758865248227e-05, 'mean_token_accuracy': 0.7271367609500885, 'epoch': 0.84}
{'loss': 0.7435, 'grad_norm': 4.054415702819824, 'learning_rate': 1.4335106382978724e-05, 'mean_token_accuracy': 0.7517229914665222, 'epoch': 0.85}
{'loss': 0.8378, 'grad_norm': 7.708598613739014, 'learning_rate': 1.424645390070922e-05, 'mean_token_accuracy': 0.7374922215938569, 'epoch': 0.86}
{'loss': 0.8211, 'grad_norm': 11.023908615112305, 'learning_rate': 1.4157801418439719e-05, 'mean_token_accuracy': 0.7511198163032532, 'epoch': 0.88}
{'loss': 0.8253, 'grad_norm': 8.004168510437012, 'learning_rate': 1.4069148936170214e-05, 'mean_token_accuracy': 0.7437738895416259, 'epoch': 0.89}
{'loss': 0.9236, 'grad_norm': 11.231510162353516, 'learning_rate': 1.398049645390071e-05, 'mean_token_accuracy': 0.7254656910896301, 'epoch': 0.9}
{'loss': 0.7684, 'grad_norm': 7.354760646820068, 'learning_rate': 1.3891843971631206e-05, 'mean_token_accuracy': 0.7679585158824921, 'epoch': 0.92}
{'loss': 0.7569, 'grad_norm': 8.298005104064941, 'learning_rate': 1.3803191489361702e-05, 'mean_token_accuracy': 0.7642908871173859, 'epoch': 0.93}
{'loss': 0.7888, 'grad_norm': 7.920668601989746, 'learning_rate': 1.37145390070922e-05, 'mean_token_accuracy': 0.7515704095363617, 'epoch': 0.94}
{'loss': 0.7623, 'grad_norm': 7.349825859069824, 'learning_rate': 1.3625886524822696e-05, 'mean_token_accuracy': 0.7692687690258027, 'epoch': 0.96}
{'loss': 0.872, 'grad_norm': 7.741388320922852, 'learning_rate': 1.3537234042553193e-05, 'mean_token_accuracy': 0.735372930765152, 'epoch': 0.97}
{'loss': 0.7935, 'grad_norm': 7.4751763343811035, 'learning_rate': 1.3448581560283689e-05, 'mean_token_accuracy': 0.7463453710079193, 'epoch': 0.98}
{'loss': 0.8286, 'grad_norm': 7.549031734466553, 'learning_rate': 1.3359929078014187e-05, 'mean_token_accuracy': 0.7395983457565307, 'epoch': 1.0}
{'loss': 0.7581, 'grad_norm': 8.211665153503418, 'learning_rate': 1.3271276595744683e-05, 'mean_token_accuracy': 0.7803336977958679, 'epoch': 1.01}
{'loss': 0.7467, 'grad_norm': 7.496240615844727, 'learning_rate': 1.3182624113475178e-05, 'mean_token_accuracy': 0.7664431154727935, 'epoch': 1.02}
{'loss': 0.7824, 'grad_norm': 7.732287406921387, 'learning_rate': 1.3093971631205675e-05, 'mean_token_accuracy': 0.7740446031093597, 'epoch': 1.04}
{'loss': 0.6903, 'grad_norm': 7.3813700675964355, 'learning_rate': 1.300531914893617e-05, 'mean_token_accuracy': 0.7805108785629272, 'epoch': 1.05}
{'loss': 0.7162, 'grad_norm': 6.899199962615967, 'learning_rate': 1.2916666666666668e-05, 'mean_token_accuracy': 0.7742939054965973, 'epoch': 1.06}
{'loss': 0.6335, 'grad_norm': 8.95841121673584, 'learning_rate': 1.2828014184397163e-05, 'mean_token_accuracy': 0.8067759931087494, 'epoch': 1.08}
{'loss': 0.6307, 'grad_norm': 9.058492660522461, 'learning_rate': 1.2739361702127662e-05, 'mean_token_accuracy': 0.7831819713115692, 'epoch': 1.09}
{'loss': 0.5788, 'grad_norm': 7.538389682769775, 'learning_rate': 1.2650709219858157e-05, 'mean_token_accuracy': 0.813993513584137, 'epoch': 1.1}
{'loss': 0.6525, 'grad_norm': 10.848623275756836, 'learning_rate': 1.2562056737588653e-05, 'mean_token_accuracy': 0.789097011089325, 'epoch': 1.12}
{'loss': 0.6341, 'grad_norm': 7.380746364593506, 'learning_rate': 1.247340425531915e-05, 'mean_token_accuracy': 0.7921646118164063, 'epoch': 1.13}
{'loss': 0.6959, 'grad_norm': 7.257918834686279, 'learning_rate': 1.2384751773049645e-05, 'mean_token_accuracy': 0.7852163016796112, 'epoch': 1.14}
{'loss': 0.5646, 'grad_norm': 8.73208999633789, 'learning_rate': 1.2296099290780144e-05, 'mean_token_accuracy': 0.8109827876091004, 'epoch': 1.16}
{'loss': 0.5878, 'grad_norm': 4.693049430847168, 'learning_rate': 1.220744680851064e-05, 'mean_token_accuracy': 0.8006817162036896, 'epoch': 1.17}
{'loss': 0.6417, 'grad_norm': 6.129785060882568, 'learning_rate': 1.2118794326241137e-05, 'mean_token_accuracy': 0.7896636128425598, 'epoch': 1.18}
{'loss': 0.571, 'grad_norm': 7.642724990844727, 'learning_rate': 1.2030141843971632e-05, 'mean_token_accuracy': 0.7994006454944611, 'epoch': 1.2}
{'loss': 0.707, 'grad_norm': 7.667198181152344, 'learning_rate': 1.1941489361702127e-05, 'mean_token_accuracy': 0.786391144990921, 'epoch': 1.21}
{'loss': 0.4932, 'grad_norm': 6.594120025634766, 'learning_rate': 1.1852836879432626e-05, 'mean_token_accuracy': 0.8242644190788269, 'epoch': 1.22}
{'loss': 0.677, 'grad_norm': 8.783164978027344, 'learning_rate': 1.1764184397163122e-05, 'mean_token_accuracy': 0.7913270115852356, 'epoch': 1.24}
{'loss': 0.6381, 'grad_norm': 6.3944783210754395, 'learning_rate': 1.1675531914893619e-05, 'mean_token_accuracy': 0.804038816690445, 'epoch': 1.25}
{'loss': 0.5969, 'grad_norm': 8.535252571105957, 'learning_rate': 1.1586879432624114e-05, 'mean_token_accuracy': 0.8112186014652252, 'epoch': 1.26}
{'loss': 0.6542, 'grad_norm': 6.514713287353516, 'learning_rate': 1.1498226950354611e-05, 'mean_token_accuracy': 0.7981089413166046, 'epoch': 1.28}
{'loss': 0.6444, 'grad_norm': 7.52887487411499, 'learning_rate': 1.1409574468085107e-05, 'mean_token_accuracy': 0.8021659970283508, 'epoch': 1.29}
{'loss': 0.5983, 'grad_norm': 7.613471508026123, 'learning_rate': 1.1320921985815602e-05, 'mean_token_accuracy': 0.799854439496994, 'epoch': 1.3}
{'loss': 0.6386, 'grad_norm': 6.86065149307251, 'learning_rate': 1.12322695035461e-05, 'mean_token_accuracy': 0.7956842541694641, 'epoch': 1.32}
{'loss': 0.644, 'grad_norm': 5.697960376739502, 'learning_rate': 1.1143617021276596e-05, 'mean_token_accuracy': 0.7974954307079315, 'epoch': 1.33}
{'loss': 0.603, 'grad_norm': 6.1758246421813965, 'learning_rate': 1.1054964539007093e-05, 'mean_token_accuracy': 0.7914800584316254, 'epoch': 1.34}
{'loss': 0.4868, 'grad_norm': 6.590397357940674, 'learning_rate': 1.0966312056737589e-05, 'mean_token_accuracy': 0.8368429243564606, 'epoch': 1.36}
{'loss': 0.5516, 'grad_norm': 6.452476978302002, 'learning_rate': 1.0877659574468088e-05, 'mean_token_accuracy': 0.8156322717666626, 'epoch': 1.37}
{'loss': 0.532, 'grad_norm': 7.160881996154785, 'learning_rate': 1.0789007092198583e-05, 'mean_token_accuracy': 0.8172541439533234, 'epoch': 1.38}
{'loss': 0.6142, 'grad_norm': 6.992453575134277, 'learning_rate': 1.0700354609929078e-05, 'mean_token_accuracy': 0.8085800409317017, 'epoch': 1.4}
{'loss': 0.5743, 'grad_norm': 5.891844749450684, 'learning_rate': 1.0611702127659575e-05, 'mean_token_accuracy': 0.8136228859424591, 'epoch': 1.41}
{'loss': 0.5208, 'grad_norm': 6.436105728149414, 'learning_rate': 1.052304964539007e-05, 'mean_token_accuracy': 0.8129067063331604, 'epoch': 1.42}
{'loss': 0.5191, 'grad_norm': 8.868505477905273, 'learning_rate': 1.0434397163120568e-05, 'mean_token_accuracy': 0.8365794718265533, 'epoch': 1.44}
{'loss': 0.4784, 'grad_norm': 6.535655975341797, 'learning_rate': 1.0345744680851065e-05, 'mean_token_accuracy': 0.8344088315963745, 'epoch': 1.45}
{'loss': 0.5434, 'grad_norm': 6.699731349945068, 'learning_rate': 1.0257092198581562e-05, 'mean_token_accuracy': 0.8171151638031006, 'epoch': 1.46}
{'loss': 0.4519, 'grad_norm': 7.270737171173096, 'learning_rate': 1.0168439716312058e-05, 'mean_token_accuracy': 0.8472539603710174, 'epoch': 1.48}
{'loss': 0.554, 'grad_norm': 8.376811027526855, 'learning_rate': 1.0079787234042555e-05, 'mean_token_accuracy': 0.8258314907550812, 'epoch': 1.49}
{'loss': 0.55, 'grad_norm': 8.108011245727539, 'learning_rate': 9.99113475177305e-06, 'mean_token_accuracy': 0.8175407171249389, 'epoch': 1.5}
{'loss': 0.5455, 'grad_norm': 2.7187857627868652, 'learning_rate': 9.902482269503547e-06, 'mean_token_accuracy': 0.8114243090152741, 'epoch': 1.52}
{'loss': 0.5026, 'grad_norm': 6.4862213134765625, 'learning_rate': 9.813829787234044e-06, 'mean_token_accuracy': 0.8214438199996948, 'epoch': 1.53}
{'loss': 0.5412, 'grad_norm': 6.713692665100098, 'learning_rate': 9.72517730496454e-06, 'mean_token_accuracy': 0.8082310795783997, 'epoch': 1.54}
{'loss': 0.5735, 'grad_norm': 6.619164943695068, 'learning_rate': 9.636524822695035e-06, 'mean_token_accuracy': 0.8196346700191498, 'epoch': 1.56}
{'loss': 0.6369, 'grad_norm': 6.375359535217285, 'learning_rate': 9.547872340425532e-06, 'mean_token_accuracy': 0.7949351727962494, 'epoch': 1.57}
{'loss': 0.5139, 'grad_norm': 6.878798007965088, 'learning_rate': 9.45921985815603e-06, 'mean_token_accuracy': 0.8322770118713378, 'epoch': 1.58}
{'loss': 0.4072, 'grad_norm': 7.437853813171387, 'learning_rate': 9.370567375886526e-06, 'mean_token_accuracy': 0.8640457570552826, 'epoch': 1.6}
{'loss': 0.5162, 'grad_norm': 7.8437018394470215, 'learning_rate': 9.281914893617022e-06, 'mean_token_accuracy': 0.8366377830505372, 'epoch': 1.61}
{'loss': 0.4542, 'grad_norm': 7.486163139343262, 'learning_rate': 9.193262411347519e-06, 'mean_token_accuracy': 0.8379100620746612, 'epoch': 1.62}
{'loss': 0.4454, 'grad_norm': 4.410977840423584, 'learning_rate': 9.104609929078016e-06, 'mean_token_accuracy': 0.8430449783802032, 'epoch': 1.64}
{'loss': 0.4493, 'grad_norm': 9.770857810974121, 'learning_rate': 9.015957446808511e-06, 'mean_token_accuracy': 0.8455218970775604, 'epoch': 1.65}
{'loss': 0.4517, 'grad_norm': 7.684875011444092, 'learning_rate': 8.927304964539007e-06, 'mean_token_accuracy': 0.848072987794876, 'epoch': 1.66}
{'loss': 0.4767, 'grad_norm': 6.833095073699951, 'learning_rate': 8.838652482269504e-06, 'mean_token_accuracy': 0.8391816556453705, 'epoch': 1.68}
{'loss': 0.4247, 'grad_norm': 9.233429908752441, 'learning_rate': 8.750000000000001e-06, 'mean_token_accuracy': 0.8581259548664093, 'epoch': 1.69}
{'loss': 0.3899, 'grad_norm': 4.721354007720947, 'learning_rate': 8.661347517730498e-06, 'mean_token_accuracy': 0.8532660722732544, 'epoch': 1.7}
{'loss': 0.3997, 'grad_norm': 9.623292922973633, 'learning_rate': 8.572695035460993e-06, 'mean_token_accuracy': 0.8589760065078735, 'epoch': 1.72}
{'loss': 0.4502, 'grad_norm': 7.851840496063232, 'learning_rate': 8.48404255319149e-06, 'mean_token_accuracy': 0.8385429561138154, 'epoch': 1.73}
{'loss': 0.4594, 'grad_norm': 6.959384918212891, 'learning_rate': 8.395390070921986e-06, 'mean_token_accuracy': 0.8406940817832946, 'epoch': 1.74}
{'loss': 0.4955, 'grad_norm': 7.27795934677124, 'learning_rate': 8.306737588652483e-06, 'mean_token_accuracy': 0.8443771064281463, 'epoch': 1.76}
{'loss': 0.4993, 'grad_norm': 7.072406768798828, 'learning_rate': 8.218085106382978e-06, 'mean_token_accuracy': 0.8345628917217255, 'epoch': 1.77}
{'loss': 0.4825, 'grad_norm': 5.115774631500244, 'learning_rate': 8.129432624113476e-06, 'mean_token_accuracy': 0.8429107129573822, 'epoch': 1.78}
{'loss': 0.4424, 'grad_norm': 7.159843921661377, 'learning_rate': 8.040780141843973e-06, 'mean_token_accuracy': 0.8641391277313233, 'epoch': 1.8}
{'loss': 0.3763, 'grad_norm': 5.571803092956543, 'learning_rate': 7.95212765957447e-06, 'mean_token_accuracy': 0.8700811386108398, 'epoch': 1.81}
{'loss': 0.3592, 'grad_norm': 5.903679370880127, 'learning_rate': 7.863475177304965e-06, 'mean_token_accuracy': 0.8752572476863861, 'epoch': 1.82}
{'loss': 0.3931, 'grad_norm': 7.36878776550293, 'learning_rate': 7.774822695035462e-06, 'mean_token_accuracy': 0.8626484572887421, 'epoch': 1.84}
{'loss': 0.3889, 'grad_norm': 9.866499900817871, 'learning_rate': 7.686170212765958e-06, 'mean_token_accuracy': 0.8709389209747315, 'epoch': 1.85}
{'loss': 0.4518, 'grad_norm': 8.120841979980469, 'learning_rate': 7.597517730496454e-06, 'mean_token_accuracy': 0.8525145530700684, 'epoch': 1.86}
{'loss': 0.366, 'grad_norm': 6.5917463302612305, 'learning_rate': 7.508865248226951e-06, 'mean_token_accuracy': 0.8613693654537201, 'epoch': 1.88}
{'loss': 0.2982, 'grad_norm': 5.328197002410889, 'learning_rate': 7.420212765957447e-06, 'mean_token_accuracy': 0.8880831062793731, 'epoch': 1.89}
{'loss': 0.4411, 'grad_norm': 6.451320171356201, 'learning_rate': 7.331560283687944e-06, 'mean_token_accuracy': 0.8601589262485504, 'epoch': 1.9}
{'loss': 0.3515, 'grad_norm': 5.598852634429932, 'learning_rate': 7.242907801418441e-06, 'mean_token_accuracy': 0.8779868602752685, 'epoch': 1.91}
{'loss': 0.3986, 'grad_norm': 7.113544940948486, 'learning_rate': 7.154255319148937e-06, 'mean_token_accuracy': 0.8617524862289428, 'epoch': 1.93}
{'loss': 0.3557, 'grad_norm': 6.571679592132568, 'learning_rate': 7.065602836879433e-06, 'mean_token_accuracy': 0.879159826040268, 'epoch': 1.94}
{'loss': 0.3837, 'grad_norm': 4.10301399230957, 'learning_rate': 6.976950354609929e-06, 'mean_token_accuracy': 0.8669856548309326, 'epoch': 1.95}
{'loss': 0.3162, 'grad_norm': 5.019718170166016, 'learning_rate': 6.888297872340426e-06, 'mean_token_accuracy': 0.8915475964546203, 'epoch': 1.97}
{'loss': 0.4385, 'grad_norm': 6.6757636070251465, 'learning_rate': 6.799645390070923e-06, 'mean_token_accuracy': 0.8594066202640533, 'epoch': 1.98}
{'loss': 0.4253, 'grad_norm': 7.527348041534424, 'learning_rate': 6.710992907801419e-06, 'mean_token_accuracy': 0.8582921743392944, 'epoch': 1.99}
{'loss': 0.3807, 'grad_norm': 7.162551403045654, 'learning_rate': 6.622340425531916e-06, 'mean_token_accuracy': 0.8768588125705719, 'epoch': 2.01}
{'loss': 0.3372, 'grad_norm': 5.729288101196289, 'learning_rate': 6.533687943262412e-06, 'mean_token_accuracy': 0.8818207919597626, 'epoch': 2.02}
{'loss': 0.2464, 'grad_norm': 3.4852566719055176, 'learning_rate': 6.445035460992908e-06, 'mean_token_accuracy': 0.9086576342582703, 'epoch': 2.03}
{'loss': 0.2863, 'grad_norm': 6.438830375671387, 'learning_rate': 6.356382978723404e-06, 'mean_token_accuracy': 0.9021755218505859, 'epoch': 2.05}
{'loss': 0.3702, 'grad_norm': 6.7917256355285645, 'learning_rate': 6.267730496453901e-06, 'mean_token_accuracy': 0.8823695957660675, 'epoch': 2.06}
{'loss': 0.3746, 'grad_norm': 7.513978004455566, 'learning_rate': 6.179078014184397e-06, 'mean_token_accuracy': 0.8842978239059448, 'epoch': 2.07}
{'loss': 0.3244, 'grad_norm': 7.092484951019287, 'learning_rate': 6.090425531914894e-06, 'mean_token_accuracy': 0.8919736206531524, 'epoch': 2.09}
{'loss': 0.3576, 'grad_norm': 4.856117248535156, 'learning_rate': 6.001773049645391e-06, 'mean_token_accuracy': 0.8851004898548126, 'epoch': 2.1}
{'loss': 0.342, 'grad_norm': 5.47867488861084, 'learning_rate': 5.913120567375888e-06, 'mean_token_accuracy': 0.8929545462131501, 'epoch': 2.11}
{'loss': 0.3003, 'grad_norm': 5.703670501708984, 'learning_rate': 5.824468085106384e-06, 'mean_token_accuracy': 0.8993511199951172, 'epoch': 2.13}
{'loss': 0.2693, 'grad_norm': 4.609493732452393, 'learning_rate': 5.735815602836879e-06, 'mean_token_accuracy': 0.9027279019355774, 'epoch': 2.14}
{'loss': 0.3184, 'grad_norm': 5.443819999694824, 'learning_rate': 5.647163120567376e-06, 'mean_token_accuracy': 0.9022117853164673, 'epoch': 2.15}
{'loss': 0.2588, 'grad_norm': 5.016439437866211, 'learning_rate': 5.558510638297873e-06, 'mean_token_accuracy': 0.8964482724666596, 'epoch': 2.17}
{'loss': 0.2837, 'grad_norm': 6.615945816040039, 'learning_rate': 5.469858156028369e-06, 'mean_token_accuracy': 0.9148551285266876, 'epoch': 2.18}
{'loss': 0.3655, 'grad_norm': 5.457818031311035, 'learning_rate': 5.381205673758866e-06, 'mean_token_accuracy': 0.8788913071155549, 'epoch': 2.19}
{'loss': 0.2965, 'grad_norm': 5.721462726593018, 'learning_rate': 5.292553191489362e-06, 'mean_token_accuracy': 0.9028539955615997, 'epoch': 2.21}
{'loss': 0.295, 'grad_norm': 6.119614601135254, 'learning_rate': 5.203900709219859e-06, 'mean_token_accuracy': 0.8958672106266021, 'epoch': 2.22}
{'loss': 0.2664, 'grad_norm': 6.457828998565674, 'learning_rate': 5.115248226950355e-06, 'mean_token_accuracy': 0.912973552942276, 'epoch': 2.23}
{'loss': 0.2138, 'grad_norm': 3.79205584526062, 'learning_rate': 5.026595744680851e-06, 'mean_token_accuracy': 0.9218945682048798, 'epoch': 2.25}
{'loss': 0.3327, 'grad_norm': 5.463805198669434, 'learning_rate': 4.937943262411347e-06, 'mean_token_accuracy': 0.8887956500053406, 'epoch': 2.26}
{'loss': 0.275, 'grad_norm': 5.20910120010376, 'learning_rate': 4.8492907801418445e-06, 'mean_token_accuracy': 0.9025092244148254, 'epoch': 2.27}
{'loss': 0.2434, 'grad_norm': 3.788684129714966, 'learning_rate': 4.760638297872341e-06, 'mean_token_accuracy': 0.9145640134811401, 'epoch': 2.29}
{'loss': 0.2549, 'grad_norm': 4.5320000648498535, 'learning_rate': 4.671985815602838e-06, 'mean_token_accuracy': 0.9103472411632538, 'epoch': 2.3}
{'loss': 0.3464, 'grad_norm': 7.502073287963867, 'learning_rate': 4.583333333333333e-06, 'mean_token_accuracy': 0.8872575104236603, 'epoch': 2.31}
{'loss': 0.2761, 'grad_norm': 5.814944744110107, 'learning_rate': 4.49468085106383e-06, 'mean_token_accuracy': 0.9112503290176391, 'epoch': 2.33}
{'loss': 0.3137, 'grad_norm': 3.2820053100585938, 'learning_rate': 4.4060283687943266e-06, 'mean_token_accuracy': 0.8962933719158173, 'epoch': 2.34}
{'loss': 0.2514, 'grad_norm': 4.1316986083984375, 'learning_rate': 4.317375886524824e-06, 'mean_token_accuracy': 0.9051554381847382, 'epoch': 2.35}
{'loss': 0.244, 'grad_norm': 4.7411370277404785, 'learning_rate': 4.228723404255319e-06, 'mean_token_accuracy': 0.9109600782394409, 'epoch': 2.37}
{'loss': 0.2255, 'grad_norm': 7.2086405754089355, 'learning_rate': 4.140070921985816e-06, 'mean_token_accuracy': 0.9245280802249909, 'epoch': 2.38}
{'loss': 0.2565, 'grad_norm': 4.430150032043457, 'learning_rate': 4.051418439716312e-06, 'mean_token_accuracy': 0.9181678712368011, 'epoch': 2.39}
  File "/mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_vlm_cot_.py", line 247, in <module>
    # Save and push to hub
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2245, in train
    return inner_training_loop(
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2627, in _inner_training_loop
    self._maybe_log_save_evaluate(
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 3103, in _maybe_log_save_evaluate
    self._save_checkpoint(model, trial)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 3211, in _save_checkpoint
    self._save_optimizer_and_scheduler(output_dir)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 3328, in _save_optimizer_and_scheduler
    self.model_wrapped.save_checkpoint(output_dir)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/deepspeed/runtime/engine.py", line 3206, in save_checkpoint
    self._save_zero_checkpoint(save_dir, tag)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/deepspeed/runtime/engine.py", line 3567, in _save_zero_checkpoint
    self.checkpoint_engine.save(zero_sd, zero_checkpoint_name)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/deepspeed/runtime/checkpoint_engine/torch_checkpoint_engine.py", line 22, in save
    torch.save(state_dict, path)
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/torch/serialization.py", line 850, in save
    _save(
  File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/torch/serialization.py", line 1114, in _save
    zip_file.write_record(name, storage, num_bytes)
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/mnt/petrelfs/majiachen/project/mllm-safety-cot/src/sft_vlm_cot_.py", line 247, in <module>
[rank0]:     # Save and push to hub
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2245, in train
[rank0]:     return inner_training_loop(
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 2627, in _inner_training_loop
[rank0]:     self._maybe_log_save_evaluate(
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 3103, in _maybe_log_save_evaluate
[rank0]:     self._save_checkpoint(model, trial)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 3211, in _save_checkpoint
[rank0]:     self._save_optimizer_and_scheduler(output_dir)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/transformers/trainer.py", line 3328, in _save_optimizer_and_scheduler
[rank0]:     self.model_wrapped.save_checkpoint(output_dir)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/deepspeed/runtime/engine.py", line 3206, in save_checkpoint
[rank0]:     self._save_zero_checkpoint(save_dir, tag)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/deepspeed/runtime/engine.py", line 3567, in _save_zero_checkpoint
[rank0]:     self.checkpoint_engine.save(zero_sd, zero_checkpoint_name)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/deepspeed/runtime/checkpoint_engine/torch_checkpoint_engine.py", line 22, in save
[rank0]:     torch.save(state_dict, path)
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/torch/serialization.py", line 850, in save
[rank0]:     _save(
[rank0]:   File "/mnt/petrelfs/majiachen/miniconda3/envs/v-oocr/lib/python3.10/site-packages/torch/serialization.py", line 1114, in _save
[rank0]:     zip_file.write_record(name, storage, num_bytes)
[rank0]: KeyboardInterrupt
